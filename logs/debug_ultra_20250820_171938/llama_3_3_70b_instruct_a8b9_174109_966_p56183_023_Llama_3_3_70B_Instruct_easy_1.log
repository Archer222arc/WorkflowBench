===== 分片 Llama-3.3-70B-Instruct_easy_1 =====
时间: 2025-08-20T17:41:09.967955
模型: llama-3.3-70b-instruct
实例: Llama-3.3-70B-Instruct-2
命令: python -u smart_batch_runner.py --model llama-3.3-70b-instruct --deployment Llama-3.3-70B-Instruct-2 --prompt-types optimal --difficulty easy --task-types all --num-instances 1 --max-workers 5 --tool-success-rate 0.8 --batch-commit --checkpoint-interval 20 --ai-classification --no-adaptive --qps 50
环境变量:
  STORAGE_FORMAT=parquet
  PYTHONFAULTHANDLER=1
  PYTHONUNBUFFERED=1
==================================================

[17:41:11.974] 2025-08-20 17:41:11,974 - faiss.loader - INFO - Loading faiss.
[17:41:11.989] 2025-08-20 17:41:11,989 - faiss.loader - INFO - Successfully loaded faiss.
[17:41:13.189] [INFO] 使用Parquet存储格式
[17:41:13.604] [INFO] 使用Parquet存储格式
[17:41:13.606] [INFO] 使用PARQUET存储格式
[17:41:13.607] 
[17:41:13.607] ============================================================
[17:41:13.607] 智能批测试: llama-3.3-70b-instruct (idealab)
[17:41:13.607] Prompt types: ['optimal']
[17:41:13.607] 难度: easy
[17:41:13.607] 目标: 每种配置 1 个实例
[17:41:13.607] ============================================================
[17:41:13.656] ○ simple_task         :   0/  1 已完成 (需要补充 1 个)
[17:41:13.664] ○ basic_task          :   0/  1 已完成 (需要补充 1 个)
[17:41:13.674] ○ data_pipeline       :   0/  1 已完成 (需要补充 1 个)
[17:41:13.683] ○ api_integration     :   0/  1 已完成 (需要补充 1 个)
[17:41:13.696] ○ multi_stage_pipeline:   0/  1 已完成 (需要补充 1 个)
[17:41:13.696] 
[17:41:13.696] ⏳ 需要运行 5 个新测试
[17:41:13.696] 
[17:41:13.696] ▶ 准备 simple_task (1 个实例)...
[17:41:13.696] 
[17:41:13.696] ▶ 准备 basic_task (1 个实例)...
[17:41:13.696] 
[17:41:13.696] ▶ 准备 data_pipeline (1 个实例)...
[17:41:13.696] 
[17:41:13.696] ▶ 准备 api_integration (1 个实例)...
[17:41:13.696] 
[17:41:13.696] ▶ 准备 multi_stage_pipeline (1 个实例)...
[17:41:13.696] 
[17:41:13.696] ▶ 开始执行 5 个测试...
[17:41:13.696] 📦 批量提交模式：每20个测试保存一次
[17:41:13.696] 🚀 检测到Azure API，使用超高并发: workers=100, qps=200.0
[17:41:13.702] 2025-08-20 17:41:13,702 - smart_model_router - INFO - ✨ Using USER's Azure endpoint for gpt-5-nano
[17:41:13.782] 2025-08-20 17:41:13,782 - txt_based_ai_classifier - INFO - TXT-based AI classifier initialized with gpt-5-nano (parameter-filtered)
[17:41:13.782] [AI_DEBUG] AI分类器初始化成功: <txt_based_ai_classifier.TxtBasedAIClassifier object at 0x160b2c230>
[17:41:13.782] 2025-08-20 17:41:13,782 - batch_test_runner - INFO - 基于TXT文件的AI错误分类系统已启用 (使用gpt-5-nano)
[17:41:13.782] [DEBUG] BatchTestRunner initialized with save_logs=True, enable_database_updates=True, use_ai_classification=True, checkpoint_interval=20
[17:41:13.783] 2025-08-20 17:41:13,783 - batch_test_runner - INFO - ============================================================
[17:41:13.783] 2025-08-20 17:41:13,783 - batch_test_runner - INFO - Batch test runner initialized
[17:41:13.783] 2025-08-20 17:41:13,783 - batch_test_runner - INFO - Configuration: debug=False, silent=False, adaptive=False
[17:41:13.783] 2025-08-20 17:41:13,783 - batch_test_runner - INFO - Log file: logs/batch_test_20250820_174113.log
[17:41:13.783] 2025-08-20 17:41:13,783 - batch_test_runner - INFO - ============================================================
[17:41:13.783] 2025-08-20 17:41:13,783 - batch_test_runner - INFO - Running 5 tests with 100 workers, QPS limit: 200.0
[17:41:13.783] 2025-08-20 17:41:13,783 - batch_test_runner - INFO - Initializing test components...
[17:41:14.072] 2025-08-20 17:41:14,072 - batch_test_runner - INFO - Found pre-generated workflows, will use them to save memory
[17:41:14.072] 2025-08-20 17:41:14,072 - batch_test_runner - INFO - ⚡ [OPTIMIZATION] Using MDPWorkflowGenerator with SKIP_MODEL_LOADING=true
[17:41:14.072] 2025-08-20 17:41:14,072 - batch_test_runner - INFO - ⚡ This saves ~350MB memory while keeping all functionality intact
[17:41:14.072] [DEBUG] Creating new ToolCapabilityManager instance
[17:41:14.072] [OperationEmbeddingIndex] Initializing with unified API client manager
[17:41:14.072] ['config/config.json', 'config/api_keys.json', 'config/api-keys.json']
[17:41:14.083] 2025-08-20 17:41:14,083 - api_client_manager - INFO - Loaded configuration from config/config.json
[17:41:14.094] [OperationEmbeddingIndex] OpenAI client initialized with model: gpt-4o-mini
[17:41:14.094] [OperationEmbeddingIndex] Using embedding model: text-embedding-3-large
[17:41:14.094] [OperationEmbeddingIndex] Detecting actual embedding dimension...
[17:41:15.044] 2025-08-20 17:41:15,044 - httpx - INFO - HTTP Request: POST https://archer222arc.openai.azure.com/openai/deployments/text-embedding-3-large/embeddings?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
[17:41:15.046] [OperationEmbeddingIndex] Detected embedding dimension: 3072
[17:41:15.116] [INFO] Loaded 4150 embeddings from persistent cache
[17:41:15.116] [OperationEmbeddingIndex] Initialized with 4150 cached embeddings
[17:41:15.122] [INFO] Loaded 15 LLM-enhanced operation definitions from cache
[17:41:15.122] [INFO] Found cached operation index at .mcp_operation_cache/operation_index.pkl
[17:41:15.122] [INFO] Loading operation index from .mcp_operation_cache/operation_index.pkl
[17:41:15.127] [INFO] Successfully loaded FAISS index with dimension 3072
[17:41:15.127] [INFO] Operation index loaded successfully from .mcp_operation_cache/operation_index.pkl
[17:41:15.127] [INFO] Loaded 15 operations with dimension 3072
[17:41:15.127] [INFO] Successfully loaded cached index
[17:41:15.127] [INFO] Operation semantic index initialized
[17:41:15.127] [INFO] Using device: cpu
[17:41:15.128] [INFO] Initialized tool success tracking attributes
[17:41:15.128] [INFO] Initializing embedding manager for enhanced tool selection
[17:41:15.128] [MCPEmbeddingManager] Creating new singleton instance
[17:41:15.128] [MCPEmbeddingManager] Initializing with unified API client manager
[17:41:15.138] [MCPEmbeddingManager] Using embedding model: text-embedding-3-large
[17:41:15.138] [MCPEmbeddingManager] Client initialized successfully
[17:41:15.138] 2025-08-20 17:41:15,138 - mcp_embedding_manager - INFO - Loading embedding cache from .mcp_embedding_cache/embedding_cache.pkl (size: 173790244 bytes)
[17:41:15.270] 2025-08-20 17:41:15,270 - mcp_embedding_manager - INFO - Loaded 7050 cached embeddings
[17:41:15.490] 2025-08-20 17:41:15,490 - mcp_embedding_manager - INFO - Loaded search cache with 3 entries
[17:41:15.490] 2025-08-20 17:41:15,490 - mcp_embedding_manager - INFO - Initialized operation mappings with 149 terms
[17:41:15.514] 2025-08-20 17:41:15,513 - mcp_embedding_manager - INFO - Loading embedding cache from .mcp_embedding_cache/embedding_cache.pkl (size: 173790244 bytes)
[17:41:15.562] 2025-08-20 17:41:15,562 - mcp_embedding_manager - INFO - Loaded 7050 cached embeddings
[17:41:15.993] 2025-08-20 17:41:15,993 - mcp_embedding_manager - INFO - [Cache] Loaded 9650 entries from file
[17:41:15.993] [MCPEmbeddingManager] Singleton created with 0 cached embeddings
[17:41:15.993] [INFO] Loading embedding index from .mcp_embedding_cache/tool_index.pkl
[17:41:15.993] 2025-08-20 17:41:15,993 - mcp_embedding_manager - INFO - Loading index from .mcp_embedding_cache/tool_index.pkl (size: 3723608 bytes)
[17:41:16.018] 2025-08-20 17:41:16,018 - mcp_embedding_manager - INFO - FAISS index loaded
[17:41:16.018] 2025-08-20 17:41:16,018 - mcp_embedding_manager - INFO - Updated dimension to 3072
[17:41:16.018] 2025-08-20 17:41:16,018 - mcp_embedding_manager - INFO - Index loaded successfully: 30 tools
[17:41:16.020] [SUCCESS] Loaded 30 tool embeddings
[17:41:16.020] 2025-08-20 17:41:16,020 - mdp_workflow_generator - INFO - Embedding index loaded successfully
[17:41:16.020] [SUCCESS] Embedding manager initialized with 30 tools
[17:41:16.020] [INFO] Initialized task types: ['simple_task', 'data_pipeline', 'api_integration', 'basic_task', 'multi_stage_pipeline']
[17:41:16.020] [INFO] Loading full MCP protocol registry...
[17:41:16.022] 2025-08-20 17:41:16,022 - mdp_workflow_generator - INFO - Loaded full tool registry from mcp_generated_library/tool_registry_consolidated.json
[17:41:16.022] [INFO] Loaded full tool registry with 30 tools
[17:41:16.022] 2025-08-20 17:41:16,022 - mdp_workflow_generator - INFO - Loading tools from mcp_generated_library/tool_registry_consolidated.json
[17:41:16.022] [INFO] Loading tools from mcp_generated_library/tool_registry_consolidated.json
[17:41:16.023] [INFO] Embedding manager ready with 30 tools
[17:41:16.023] [WARNING] Embedding manager exists but has no embeddings
[17:41:16.023] [INFO] Consider rebuilding index with: embedding_manager.build_index(tools_path)
[17:41:16.023] [INFO] Tool file_operations_reader: semantic operations = ['read', 'write', 'parse', 'transform']
[17:41:16.023] [INFO] Tool file_operations_scanner: semantic operations = ['read', 'write', 'parse', 'transform']
[17:41:16.023] [INFO] Tool network_fetcher: semantic operations = ['read', 'write', 'validate', 'integrate']
[17:41:16.023] [INFO] Tool integration_authenticator: semantic operations = ['integrate', 'transform', 'validate']
[17:41:16.023] [INFO] Tool utility_logger: semantic operations = ['cache', 'process']
[17:41:16.023] [INFO] Tool data_processing_parser: semantic operations = ['validate', 'transform', 'filter', 'aggregate']
[17:41:16.023] [INFO] Tool data_processing_transformer: semantic operations = ['validate', 'transform', 'filter', 'aggregate']
[17:41:16.023] [INFO] Tool data_processing_validator: semantic operations = ['validate', 'transform', 'filter', 'aggregate']
[17:41:16.023] [INFO] Tool network_validator: semantic operations = ['read', 'write', 'validate', 'integrate']
[17:41:16.023] [INFO] Tool computation_calculator: semantic operations = ['compute', 'aggregate', 'transform']
[17:41:16.023] [INFO] Tool data_processing_filter: semantic operations = ['validate', 'transform', 'filter', 'aggregate']
[17:41:16.023] [INFO] Tool data_processing_aggregator: semantic operations = ['validate', 'transform', 'filter', 'aggregate']
[17:41:16.023] [INFO] Tool file_operations_converter: semantic operations = ['read', 'write', 'parse', 'transform']
[17:41:16.023] [INFO] Tool file_operations_compressor: semantic operations = ['read', 'write', 'parse', 'transform']
[17:41:16.023] [INFO] Tool file_operations_writer: semantic operations = ['read', 'write', 'parse', 'transform']
[17:41:16.023] [INFO] Tool network_poster: semantic operations = ['read', 'write', 'validate', 'integrate']
[17:41:16.023] [INFO] Tool network_monitor: semantic operations = ['read', 'write', 'validate', 'integrate']
[17:41:16.023] [INFO] Tool network_router: semantic operations = ['read', 'write', 'validate', 'integrate']
[17:41:16.023] [INFO] Tool computation_predictor: semantic operations = ['compute', 'aggregate', 'transform']
[17:41:16.023] [INFO] Tool computation_analyzer: semantic operations = ['compute', 'aggregate', 'transform']
[17:41:16.023] [INFO] Tool computation_simulator: semantic operations = ['compute', 'aggregate', 'transform']
[17:41:16.023] [INFO] Tool computation_optimizer: semantic operations = ['compute', 'aggregate', 'transform']
[17:41:16.023] [INFO] Tool integration_mapper: semantic operations = ['integrate', 'transform', 'validate']
[17:41:16.023] [INFO] Tool integration_queue: semantic operations = ['integrate', 'transform', 'validate']
[17:41:16.023] [INFO] Tool integration_scheduler: semantic operations = ['integrate', 'transform', 'validate']
[17:41:16.023] [INFO] Tool integration_connector: semantic operations = ['integrate', 'transform', 'validate']
[17:41:16.023] [INFO] Tool utility_cache: semantic operations = ['cache', 'process']
[17:41:16.023] [INFO] Tool utility_tracker: semantic operations = ['cache', 'process']
[17:41:16.023] [INFO] Tool utility_helper: semantic operations = ['cache', 'process']
[17:41:16.023] [INFO] Tool utility_notifier: semantic operations = ['cache', 'process']
[17:41:16.023] 2025-08-20 17:41:16,023 - mdp_workflow_generator - INFO - Loaded 30 tools
[17:41:16.023] [INFO] Setting default state_dim based on loaded tools
[17:41:16.023] [INFO] state_dim set to 345 (tools=30, base=340, task_types=5)
[17:41:16.023] 2025-08-20 17:41:16,023 - mdp_workflow_generator - INFO - Default state_dim calculated: 345
[17:41:16.023] [INFO] Setting default action_dim based on loaded tools
[17:41:16.023] [INFO] action_dim set to 31 (tools=30 + NO_OP)
[17:41:16.023] 2025-08-20 17:41:16,023 - mdp_workflow_generator - INFO - Default action_dim calculated: 31
[17:41:16.023] [INFO] ⚡ SKIP_MODEL_LOADING=true - Skipping neural network model loading
[17:41:16.023] [INFO] ⚡ Memory optimization: Saving ~350MB by not loading model
[17:41:16.023] [INFO] ⚡ Will use pre-generated workflows or random policy
[17:41:16.023] 2025-08-20 17:41:16,023 - mdp_workflow_generator - INFO - Model loading skipped for memory optimization (SKIP_MODEL_LOADING=true)
[17:41:16.023] [INFO] Initializing TaskManager...
[17:41:17.113] 2025-08-20 17:41:17,113 - unified_training_manager - INFO - Using device: cpu
[17:41:17.227] 2025-08-20 17:41:17,226 - unified_training_manager - INFO - Task filtering results:
[17:41:17.227] 2025-08-20 17:41:17,227 - unified_training_manager - INFO -   Total: 5040 -> 5040
[17:41:17.227] 2025-08-20 17:41:17,227 - unified_training_manager - INFO -   simple_task: 320 -> 320
[17:41:17.227] 2025-08-20 17:41:17,227 - unified_training_manager - INFO -   data_pipeline: 1520 -> 1520
[17:41:17.227] 2025-08-20 17:41:17,227 - unified_training_manager - INFO -   api_integration: 1360 -> 1360
[17:41:17.227] 2025-08-20 17:41:17,227 - unified_training_manager - INFO -   basic_task: 1200 -> 1200
[17:41:17.227] 2025-08-20 17:41:17,227 - unified_training_manager - INFO -   multi_stage_pipeline: 640 -> 640
[17:41:17.227] 2025-08-20 17:41:17,227 - unified_training_manager - INFO - Loaded 5040 tasks from mcp_generated_library/task_library_all_difficulties.json
[17:41:17.229] 2025-08-20 17:41:17,229 - unified_training_manager - INFO - Organized tasks: 5 types, 3 complexity levels, 5 difficulty levels
[17:41:17.229] [TaskManager] Difficulty level 'easy': 1096 tasks
[17:41:17.229] [TaskManager] Difficulty level 'very_easy': 856 tasks
[17:41:17.229] [TaskManager] Difficulty level 'medium': 1136 tasks
[17:41:17.229] [TaskManager] Difficulty level 'hard': 1096 tasks
[17:41:17.229] [TaskManager] Difficulty level 'very_hard': 856 tasks
[17:41:17.231] [INFO] TaskManager initialized with 5040 tasks
[17:41:17.231] [INFO] Task types available: ['basic_task', 'data_pipeline', 'multi_stage_pipeline', 'simple_task', 'api_integration']
[17:41:17.231] [INFO] Initializing ToolCallVerifier...
[17:41:17.231] [INFO] ToolCallVerifier initialized with 30 tools
[17:41:17.231] [INFO] Output tools identified: 1
[17:41:17.231] [INFO] Component initialization status:
[17:41:17.231]   - embedding_manager: initialized
[17:41:17.231]   - task_manager: initialized
[17:41:17.231]   - output_verifier: initialized
[17:41:17.232]   - tool_capability_manager: initialized
[17:41:17.232]   - tool_success_rates: initialized with 0 entries
[17:41:17.232] [INFO] MDPWorkflowGenerator initialization complete
[17:41:17.232] 2025-08-20 17:41:17,231 - mdp_workflow_generator - INFO - MDPWorkflowGenerator initialized successfully
[17:41:17.232] 2025-08-20 17:41:17,231 - batch_test_runner - INFO - ✅ MDPWorkflowGenerator initialized successfully:
[17:41:17.232] 2025-08-20 17:41:17,232 - batch_test_runner - INFO -   - task_manager: ✓
[17:41:17.232] 2025-08-20 17:41:17,232 - batch_test_runner - INFO -   - output_verifier: ✓
[17:41:17.232] 2025-08-20 17:41:17,232 - batch_test_runner - INFO -   - embedding_manager: ✓
[17:41:17.232] 2025-08-20 17:41:17,232 - batch_test_runner - INFO -   - tool_capabilities: 30 tools
[17:41:17.232] 2025-08-20 17:41:17,232 - batch_test_runner - INFO -   - neural network: skipped (saving 350MB)
[17:41:17.232] [MCPEmbeddingManager] Reusing existing singleton instance (id: 12959812448)
[17:41:17.232] [MCPEmbeddingManager] Current cache size: 30 embeddings
[17:41:17.232] [FlawedWorkflowGenerator] Initialized with 30 tools
[17:41:17.232] [FlawedWorkflowGenerator] RAG support: disabled
[17:41:17.232] DEBUG: Checking generator attributes
[17:41:17.232]   - has tool_capabilities: True
[17:41:17.232]   - has tool_capability_manager: True
[17:41:17.232]   - has task_manager: True
[17:41:17.232] [INFO] Loaded 30 tools from generator
[17:41:17.232] [INFO] Tool names sample: ['computation_analyzer', 'computation_calculator', 'computation_optimizer', 'computation_predictor', 'computation_simulator']...
[17:41:17.232] [MCPEmbeddingManager] Reusing existing singleton instance (id: 12959812448)
[17:41:17.232] [MCPEmbeddingManager] Current cache size: 30 embeddings
[17:41:17.232] [INFO] Initializing LLM client using APIClientManager
[17:41:17.238] [INFO] Using Azure OpenAI client
[17:41:17.238] [DEBUG] Checking if generator has tool_capability_manager attribute
[17:41:17.238] [DEBUG] Creating FlawedWorkflowGenerator with correct parameters
[17:41:17.238] [MCPEmbeddingManager] Reusing existing singleton instance (id: 12959812448)
[17:41:17.238] [MCPEmbeddingManager] Current cache size: 30 embeddings
[17:41:17.238] [FlawedWorkflowGenerator] Initialized with 30 tools
[17:41:17.238] [FlawedWorkflowGenerator] RAG support: enabled
[17:41:17.238] [INFO] FlawedWorkflowGenerator initialized successfully
[17:41:17.238] [INFO] Initializing StableScorer for Phase 2 scoring
[17:41:17.238] <tool_capability_manager.ToolCapabilityManager object at 0x303fbb5c0>
[17:41:17.238] [MCPEmbeddingManager] Reusing existing singleton instance (id: 12959812448)
[17:41:17.238] [MCPEmbeddingManager] Current cache size: 30 embeddings
[17:41:17.238] [INFO] Loaded tool success history for 0 tools
[17:41:17.238] [INFO] StableScorer initialized with semantic capability
[17:41:17.238] [INFO] StableScorer initialized successfully
[17:41:17.238] [INFO] Loading task instances...
[17:41:17.238] [INFO] Loading task instances from mcp_generated_library/difficulty_versions/task_library_enhanced_v3_easy.json
[17:41:17.249] [INFO] Loaded 630 task instances
[17:41:17.249] [INFO] Task instances loaded: ['basic_task', 'data_pipeline', 'multi_stage_pipeline', 'simple_task', 'api_integration']
[17:41:17.249] 2025-08-20 17:41:17,249 - batch_test_runner - INFO - Loading task library with pre-generated workflows: task_library_enhanced_v3_easy_with_workflows.json
[17:41:17.249] 2025-08-20 17:41:17,249 - batch_test_runner - INFO - Using partial loading: 20 tasks per type
[17:41:17.569] 2025-08-20 17:41:17,569 - batch_test_runner - INFO - Partially loaded 100 tasks (vs 630 total)
[17:41:17.569] 2025-08-20 17:41:17,569 - batch_test_runner - INFO - Estimated memory saving: 84.1%
[17:41:17.586] 2025-08-20 17:41:17,586 - batch_test_runner - INFO - Initialization complete
[17:41:17.611] 2025-08-20 17:41:17,611 - batch_test_runner - INFO - Detected Azure API, disabling QPS sleep for better performance
[17:41:17.611] 2025-08-20 17:41:17,611 - batch_test_runner - INFO - Starting batch test with 5 tasks, 100 workers
[17:41:17.611] 2025-08-20 17:41:17,611 - batch_test_runner - INFO - Each task timeout: 10 minutes, Total batch timeout: 20 minutes
[17:41:17.612] [InteractiveExecutor] No LLM client provided, initializing from api_client_manager
[17:41:17.612] [InteractiveExecutor] No LLM client provided, initializing from api_client_manager
[17:41:17.612] [InteractiveExecutor] No LLM client provided, initializing from api_client_manager
[17:41:17.612] 2025-08-20 17:41:17,612 - smart_model_router - INFO - ✨ Using USER's Azure endpoint for Llama-3.3-70B-Instruct-2
[17:41:17.890] [InteractiveExecutor] No LLM client provided, initializing from api_client_manager
[17:41:17.890] [InteractiveExecutor] No LLM client provided, initializing from api_client_manager
[17:41:17.896] [InteractiveExecutor] Initialized client with model: Llama-3.3-70B-Instruct-2
[17:41:17.896] [InteractiveExecutor] Using prompt type: optimal for API key selection
[17:41:17.896] [InteractiveExecutor] Initialized client with model: Llama-3.3-70B-Instruct-2
[17:41:17.896] [InteractiveExecutor] Using prompt type: optimal for API key selection
[17:41:17.897] [InteractiveExecutor] API model name: Llama-3.3-70B-Instruct-2
[17:41:17.897] [MCPEmbeddingManager] Reusing existing singleton instance (id: 12959812448)
[17:41:17.897] [MCPEmbeddingManager] Current cache size: 30 embeddings
[17:41:17.897] 2025-08-20 17:41:17,897 - mcp_embedding_manager - INFO - Loading index from .mcp_embedding_cache/tool_index.pkl (size: 3723608 bytes)
[17:41:17.897] [InteractiveExecutor] Initialized client with model: Llama-3.3-70B-Instruct-2
[17:41:17.897] [InteractiveExecutor] Using prompt type: optimal for API key selection
[17:41:17.897] [InteractiveExecutor] Initialized client with model: Llama-3.3-70B-Instruct-2
[17:41:17.897] [InteractiveExecutor] Using prompt type: optimal for API key selection
[17:41:17.897] [InteractiveExecutor] API model name: Llama-3.3-70B-Instruct-2
[17:41:17.897] [MCPEmbeddingManager] Reusing existing singleton instance (id: 12959812448)
[17:41:17.897] [MCPEmbeddingManager] Current cache size: 30 embeddings
[17:41:17.897] 2025-08-20 17:41:17,897 - mcp_embedding_manager - INFO - Loading index from .mcp_embedding_cache/tool_index.pkl (size: 3723608 bytes)
[17:41:17.898] [InteractiveExecutor] Initialized client with model: Llama-3.3-70B-Instruct-2
[17:41:17.898] [InteractiveExecutor] Using prompt type: optimal for API key selection
[17:41:17.904] [InteractiveExecutor] API model name: Llama-3.3-70B-Instruct-2[InteractiveExecutor] API model name: Llama-3.3-70B-Instruct-2
[17:41:17.904] [MCPEmbeddingManager] Reusing existing singleton instance (id: 12959812448)
[17:41:17.905] [InteractiveExecutor] API model name: Llama-3.3-70B-Instruct-2[MCPEmbeddingManager] Current cache size: 30 embeddings
[17:41:17.905] 
[17:41:17.905] 
[17:41:17.905] [MCPEmbeddingManager] Reusing existing singleton instance (id: 12959812448)
[17:41:17.905] [MCPEmbeddingManager] Current cache size: 30 embeddings
[17:41:17.905] 2025-08-20 17:41:17,905 - mcp_embedding_manager - INFO - Loading index from .mcp_embedding_cache/tool_index.pkl (size: 3723608 bytes)
[17:41:17.905] 2025-08-20 17:41:17,905 - mcp_embedding_manager - INFO - Loading index from .mcp_embedding_cache/tool_index.pkl (size: 3723608 bytes)
[17:41:17.905] [MCPEmbeddingManager] Reusing existing singleton instance (id: 12959812448)
[17:41:17.905] [MCPEmbeddingManager] Current cache size: 30 embeddings
[17:41:17.915] 2025-08-20 17:41:17,915 - mcp_embedding_manager - INFO - Loading index from .mcp_embedding_cache/tool_index.pkl (size: 3723608 bytes)
[17:41:17.921] 2025-08-20 17:41:17,921 - mcp_embedding_manager - INFO - FAISS index loaded
[17:41:17.921] 2025-08-20 17:41:17,921 - mcp_embedding_manager - INFO - Updated dimension to 3072
[17:41:17.921] 2025-08-20 17:41:17,921 - mcp_embedding_manager - INFO - Index loaded successfully: 30 tools
[17:41:17.924] [INFO] Tool embedding index loaded successfully
[17:41:17.949] [INFO] Loaded full tool registry from mcp_generated_library/tool_registry_consolidated.json
[17:41:17.970] [INFO] Operation semantic index initialized
[17:41:17.970] 
[17:41:17.970] [TURN 1/10]
[17:41:17.972] 2025-08-20 17:41:17,972 - mcp_embedding_manager - INFO - FAISS index loaded
[17:41:17.972] 2025-08-20 17:41:17,972 - mcp_embedding_manager - INFO - Updated dimension to 3072
[17:41:17.973] [LLM_CALL] Using model: Llama-3.3-70B-Instruct-2, API name: Llama-3.3-70B-Instruct-2
[17:41:17.975] 2025-08-20 17:41:17,972 - mcp_embedding_manager - INFO - FAISS index loaded
[17:41:17.984] 2025-08-20 17:41:17,972 - mcp_embedding_manager - INFO - FAISS index loaded
[17:41:17.984] 2025-08-20 17:41:17,972 - mcp_embedding_manager - INFO - Index loaded successfully: 30 tools
[17:41:17.986] [INFO] Tool embedding index loaded successfully
[17:41:17.987] 2025-08-20 17:41:17,975 - mcp_embedding_manager - INFO - Updated dimension to 3072
[17:41:17.987] 2025-08-20 17:41:17,986 - mcp_embedding_manager - INFO - Index loaded successfully: 30 tools
[17:41:17.989] [INFO] Tool embedding index loaded successfully
[17:41:17.989] 2025-08-20 17:41:17,984 - mcp_embedding_manager - INFO - Updated dimension to 3072
[17:41:17.989] 2025-08-20 17:41:17,989 - mcp_embedding_manager - INFO - Index loaded successfully: 30 tools
[17:41:17.991] [INFO] Tool embedding index loaded successfully
[17:41:17.992] 2025-08-20 17:41:17,984 - mcp_embedding_manager - INFO - FAISS index loaded
[17:41:17.992] 2025-08-20 17:41:17,992 - mcp_embedding_manager - INFO - Updated dimension to 3072
[17:41:17.992] 2025-08-20 17:41:17,992 - mcp_embedding_manager - INFO - Index loaded successfully: 30 tools
[17:41:17.994] [INFO] Tool embedding index loaded successfully
[17:41:17.994] [INFO] Loaded full tool registry from mcp_generated_library/tool_registry_consolidated.json
[17:41:17.995] [INFO] Loaded full tool registry from mcp_generated_library/tool_registry_consolidated.json
[17:41:17.995] [INFO] Operation semantic index initialized
[17:41:17.995] [INFO] Operation semantic index initialized
[17:41:17.995] [INFO] Loaded full tool registry from mcp_generated_library/tool_registry_consolidated.json
[17:41:17.995] 
[17:41:17.995] [TURN 1/10]
[17:41:17.995] [INFO] Operation semantic index initialized
[17:41:17.996] 
[17:41:17.996] [TURN 1/10]
[17:41:17.996] [LLM_CALL] Using model: Llama-3.3-70B-Instruct-2, API name: Llama-3.3-70B-Instruct-2
[17:41:17.996] 
[17:41:17.996] [TURN 1/10]
[17:41:17.997] [INFO] Loaded full tool registry from mcp_generated_library/tool_registry_consolidated.json
[17:41:17.997] [INFO] Operation semantic index initialized
[17:41:17.997] 
[17:41:17.997] [TURN 1/10]
[17:41:17.997] [LLM_CALL] Using model: Llama-3.3-70B-Instruct-2, API name: Llama-3.3-70B-Instruct-2
[17:41:17.998] [LLM_CALL] Using model: Llama-3.3-70B-Instruct-2, API name: Llama-3.3-70B-Instruct-2
[17:41:17.999] [LLM_CALL] Using model: Llama-3.3-70B-Instruct-2, API name: Llama-3.3-70B-Instruct-2
[17:41:18.908] 2025-08-20 17:41:18,908 - httpx - INFO - HTTP Request: POST https://85409-me3ofvov-eastus2.services.ai.azure.com/openai/deployments/Llama-3.3-70B-Instruct-2/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
[17:41:18.910]   [EARLY_EXIT] No actions taken, continuing...
[17:41:18.910] 
[17:41:18.910] [TURN 2/10]
[17:41:18.910] [LLM_CALL] Using model: Llama-3.3-70B-Instruct-2, API name: Llama-3.3-70B-Instruct-2
[17:41:18.926] 2025-08-20 17:41:18,926 - httpx - INFO - HTTP Request: POST https://85409-me3ofvov-eastus2.services.ai.azure.com/openai/deployments/Llama-3.3-70B-Instruct-2/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
[17:41:18.927]   [EARLY_EXIT] No actions taken, continuing...
[17:41:18.927] 
[17:41:18.927] [TURN 2/10]
[17:41:18.927] [LLM_CALL] Using model: Llama-3.3-70B-Instruct-2, API name: Llama-3.3-70B-Instruct-2
[17:41:19.071] 2025-08-20 17:41:19,071 - httpx - INFO - HTTP Request: POST https://85409-me3ofvov-eastus2.services.ai.azure.com/openai/deployments/Llama-3.3-70B-Instruct-2/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
[17:41:19.073]   [EARLY_EXIT] No actions taken, continuing...
[17:41:19.073] 
[17:41:19.073] [TURN 2/10]
[17:41:19.074] [LLM_CALL] Using model: Llama-3.3-70B-Instruct-2, API name: Llama-3.3-70B-Instruct-2
[17:41:19.106] 2025-08-20 17:41:19,106 - httpx - INFO - HTTP Request: POST https://85409-me3ofvov-eastus2.services.ai.azure.com/openai/deployments/Llama-3.3-70B-Instruct-2/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
[17:41:19.107]   [EARLY_EXIT] No actions taken, continuing...
[17:41:19.107] 
[17:41:19.107] [TURN 2/10]
[17:41:19.108] [LLM_CALL] Using model: Llama-3.3-70B-Instruct-2, API name: Llama-3.3-70B-Instruct-2
[17:41:19.573] 2025-08-20 17:41:19,573 - httpx - INFO - HTTP Request: POST https://85409-me3ofvov-eastus2.services.ai.azure.com/openai/deployments/Llama-3.3-70B-Instruct-2/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
[17:41:19.575]   [EARLY_EXIT] No actions taken, continuing...
[17:41:19.575] 
[17:41:19.575] [TURN 3/10]
[17:41:19.576] [LLM_CALL] Using model: Llama-3.3-70B-Instruct-2, API name: Llama-3.3-70B-Instruct-2
[17:41:19.644] 2025-08-20 17:41:19,643 - httpx - INFO - HTTP Request: POST https://85409-me3ofvov-eastus2.services.ai.azure.com/openai/deployments/Llama-3.3-70B-Instruct-2/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
[17:41:19.647]   [EARLY_EXIT] No actions taken, continuing...
[17:41:19.647] 
[17:41:19.647] [TURN 3/10]
[17:41:19.648] [LLM_CALL] Using model: Llama-3.3-70B-Instruct-2, API name: Llama-3.3-70B-Instruct-2
[17:41:19.688] 2025-08-20 17:41:19,688 - httpx - INFO - HTTP Request: POST https://85409-me3ofvov-eastus2.services.ai.azure.com/openai/deployments/Llama-3.3-70B-Instruct-2/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
[17:41:19.691]   [SEARCH] Query: file reader
[17:41:19.692] 
[17:41:19.692] [TURN 2/10]
[17:41:19.693] [LLM_CALL] Using model: Llama-3.3-70B-Instruct-2, API name: Llama-3.3-70B-Instruct-2
[17:41:19.822] 2025-08-20 17:41:19,822 - httpx - INFO - HTTP Request: POST https://85409-me3ofvov-eastus2.services.ai.azure.com/openai/deployments/Llama-3.3-70B-Instruct-2/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
[17:41:19.823]   [SEARCH] Query: file reader
[17:41:19.823] 
[17:41:19.823] [TURN 3/10]
[17:41:19.825] [LLM_CALL] Using model: Llama-3.3-70B-Instruct-2, API name: Llama-3.3-70B-Instruct-2
[17:41:20.085] 2025-08-20 17:41:20,085 - httpx - INFO - HTTP Request: POST https://85409-me3ofvov-eastus2.services.ai.azure.com/openai/deployments/Llama-3.3-70B-Instruct-2/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
[17:41:20.086]   [EARLY_EXIT] No actions taken, continuing...
[17:41:20.086] 
[17:41:20.086] [TURN 4/10]
[17:41:20.087] [LLM_CALL] Using model: Llama-3.3-70B-Instruct-2, API name: Llama-3.3-70B-Instruct-2
[17:41:20.621] 2025-08-20 17:41:20,621 - httpx - INFO - HTTP Request: POST https://85409-me3ofvov-eastus2.services.ai.azure.com/openai/deployments/Llama-3.3-70B-Instruct-2/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
[17:41:20.627]   [EARLY_EXIT] No actions taken, continuing...
[17:41:20.627] 
[17:41:20.627] [TURN 5/10]
[17:41:20.628] [LLM_CALL] Using model: Llama-3.3-70B-Instruct-2, API name: Llama-3.3-70B-Instruct-2
[17:41:20.962] 2025-08-20 17:41:20,962 - httpx - INFO - HTTP Request: POST https://85409-me3ofvov-eastus2.services.ai.azure.com/openai/deployments/Llama-3.3-70B-Instruct-2/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
[17:41:20.964]   [EARLY_EXIT] No actions taken, continuing...
[17:41:20.964] 
[17:41:20.964] [TURN 4/10]
[17:41:20.965] [LLM_CALL] Using model: Llama-3.3-70B-Instruct-2, API name: Llama-3.3-70B-Instruct-2
[17:41:21.743] 2025-08-20 17:41:21,742 - httpx - INFO - HTTP Request: POST https://85409-me3ofvov-eastus2.services.ai.azure.com/openai/deployments/Llama-3.3-70B-Instruct-2/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
[17:41:21.744]   [SEARCH] Query: file reader
[17:41:21.745] 
[17:41:21.745] [TURN 6/10]
[17:41:21.752] [LLM_CALL] Using model: Llama-3.3-70B-Instruct-2, API name: Llama-3.3-70B-Instruct-2
[17:41:22.361] 2025-08-20 17:41:22,357 - httpx - INFO - HTTP Request: POST https://85409-me3ofvov-eastus2.services.ai.azure.com/openai/deployments/Llama-3.3-70B-Instruct-2/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
[17:41:22.362]   [FORMAT_ISSUE] Turn 6: No tools executed after multiple turns
[17:41:22.362] 
[17:41:22.362] [TURN 7/10]
[17:41:22.368] [LLM_CALL] Using model: Llama-3.3-70B-Instruct-2, API name: Llama-3.3-70B-Instruct-2
[17:41:23.266] 2025-08-20 17:41:23,264 - httpx - INFO - HTTP Request: POST https://85409-me3ofvov-eastus2.services.ai.azure.com/openai/deployments/Llama-3.3-70B-Instruct-2/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
[17:41:23.269]   [PARSE] Found tool call: file_operations_reader
[17:41:23.273]   [EXECUTING] file_operations_reader
[17:41:23.274]     Result: SUCCESS
[17:41:23.274] 
[17:41:23.274] [TURN 8/10]
[17:41:23.284] [LLM_CALL] Using model: Llama-3.3-70B-Instruct-2, API name: Llama-3.3-70B-Instruct-2
[17:41:24.094] 2025-08-20 17:41:24,093 - httpx - INFO - HTTP Request: POST https://85409-me3ofvov-eastus2.services.ai.azure.com/openai/deployments/Llama-3.3-70B-Instruct-2/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
[17:41:24.095]   [FORMAT_ISSUE] Turn 8: Detected potential tool 'y' in incorrect format; Mentioned using 'file_operations_reader' but no proper tool call found
[17:41:24.095]   [FORMAT_ISSUE] Potential tools detected: ['y', 'file_operations_reader']
[17:41:24.095] 
[17:41:24.095] [TURN 9/10]
[17:41:24.098] [LLM_CALL] Using model: Llama-3.3-70B-Instruct-2, API name: Llama-3.3-70B-Instruct-2
[17:41:24.994] 2025-08-20 17:41:24,994 - httpx - INFO - HTTP Request: POST https://85409-me3ofvov-eastus2.services.ai.azure.com/openai/deployments/Llama-3.3-70B-Instruct-2/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
[17:41:25.003]   [PARSE] Found tool call: data_processing_parser
[17:41:25.003]   [EXECUTING] data_processing_parser
[17:41:25.003]     Result: SUCCESS
[17:41:25.003] 
[17:41:25.003] [TURN 10/10]
[17:41:25.004] [LLM_CALL] Using model: Llama-3.3-70B-Instruct-2, API name: Llama-3.3-70B-Instruct-2
[17:41:26.105] 2025-08-20 17:41:26,105 - httpx - INFO - HTTP Request: POST https://85409-me3ofvov-eastus2.services.ai.azure.com/openai/deployments/Llama-3.3-70B-Instruct-2/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
[17:41:26.106]   [PARSE] Found tool call: file_operations_reader
[17:41:26.106]   [EXECUTING] file_operations_reader
[17:41:26.106]     Result: SUCCESS
[17:41:26.106] 
[17:41:26.106] [TURN 5/10]
[17:41:26.111] [LLM_CALL] Using model: Llama-3.3-70B-Instruct-2, API name: Llama-3.3-70B-Instruct-2
[17:41:26.294] 2025-08-20 17:41:26,293 - httpx - INFO - HTTP Request: POST https://85409-me3ofvov-eastus2.services.ai.azure.com/openai/deployments/Llama-3.3-70B-Instruct-2/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
[17:41:26.299]   [PARSE] Found tool call: data_processing_filter
[17:41:26.299]   [EXECUTING] data_processing_filter
[17:41:26.299]     Result: SUCCESS
[17:41:26.299] [ASSISTED] Task received 2 format helps, final result: full_success
[17:41:26.299] [DEBUG] Got result for task: has_result=True, save_logs=True
[17:41:26.896] 2025-08-20 17:41:26,895 - httpx - INFO - HTTP Request: POST https://85409-me3ofvov-eastus2.services.ai.azure.com/openai/deployments/Llama-3.3-70B-Instruct-2/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
[17:41:26.897]   [FORMAT_ISSUE] Turn 5: Detected potential tool 'y' in incorrect format
[17:41:26.897]   [FORMAT_ISSUE] Potential tools detected: ['y']
[17:41:26.897] 
[17:41:26.897] [TURN 6/10]
[17:41:26.899] [LLM_CALL] Using model: Llama-3.3-70B-Instruct-2, API name: Llama-3.3-70B-Instruct-2
[17:41:27.653] 2025-08-20 17:41:27,653 - httpx - INFO - HTTP Request: POST https://85409-me3ofvov-eastus2.services.ai.azure.com/openai/deployments/Llama-3.3-70B-Instruct-2/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
[17:41:27.656]   [FORMAT_ISSUE] Turn 6: Detected potential tool 'y' in incorrect format
[17:41:27.656]   [FORMAT_ISSUE] Potential tools detected: ['y']
[17:41:27.656] 
[17:41:27.656] [TURN 7/10]
[17:41:27.657] [LLM_CALL] Using model: Llama-3.3-70B-Instruct-2, API name: Llama-3.3-70B-Instruct-2
[17:41:28.361] 2025-08-20 17:41:28,361 - httpx - INFO - HTTP Request: POST https://85409-me3ofvov-eastus2.services.ai.azure.com/openai/deployments/Llama-3.3-70B-Instruct-2/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
[17:41:28.363]   [FORMAT_ISSUE] Turn 7: Detected potential tool 'y' in incorrect format
[17:41:28.364]   [FORMAT_ISSUE] Potential tools detected: ['y']
[17:41:28.364] 
[17:41:28.364] [TURN 8/10]
[17:41:28.365] [LLM_CALL] Using model: Llama-3.3-70B-Instruct-2, API name: Llama-3.3-70B-Instruct-2
[17:41:29.128] 2025-08-20 17:41:29,128 - httpx - INFO - HTTP Request: POST https://85409-me3ofvov-eastus2.services.ai.azure.com/openai/deployments/Llama-3.3-70B-Instruct-2/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
[17:41:29.129]   [FORMAT_ISSUE] Turn 8: Detected potential tool 'y' in incorrect format
[17:41:29.129]   [FORMAT_ISSUE] Potential tools detected: ['y']
[17:41:29.129] 
[17:41:29.129] [TURN 9/10]
[17:41:29.131] [LLM_CALL] Using model: Llama-3.3-70B-Instruct-2, API name: Llama-3.3-70B-Instruct-2
[17:41:30.283] 2025-08-20 17:41:30,283 - httpx - INFO - HTTP Request: POST https://85409-me3ofvov-eastus2.services.ai.azure.com/openai/deployments/Llama-3.3-70B-Instruct-2/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
[17:41:30.284]   [PARSE] Found tool call: data_processing_transformer
[17:41:30.284]   [EXECUTING] data_processing_transformer
[17:41:30.284]     [DEPENDENCY] Missing: data_processing_parser, success rate reduced
[17:41:30.284]     Result: SUCCESS
[17:41:30.284] 
[17:41:30.284] [TURN 10/10]
[17:41:30.284] [LLM_CALL] Using model: Llama-3.3-70B-Instruct-2, API name: Llama-3.3-70B-Instruct-2
[17:41:30.848] 2025-08-20 17:41:30,848 - httpx - INFO - HTTP Request: POST https://85409-me3ofvov-eastus2.services.ai.azure.com/openai/deployments/Llama-3.3-70B-Instruct-2/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
[17:41:30.848]   [FORMAT_ISSUE] Turn 10: Detected potential tool 'y' in incorrect format
[17:41:30.848]   [FORMAT_ISSUE] Potential tools detected: ['y']
[17:41:30.848] [ASSISTED] Task received 5 format helps, final result: failure
[17:41:30.848] [DEBUG RAG] data_processing_filter semantically matched with data_processing_transformer (score: 0.716)
[17:41:30.848] [DEBUG RAG] data_processing_validator semantically matched with data_processing_transformer (score: 0.617)
[17:41:30.848] [DEBUG RAG] data_processing_aggregator semantically matched with data_processing_transformer (score: 0.635)
[17:41:30.849] [DEBUG] Got result for task: has_result=True, save_logs=True
[17:41:30.849] [AI_DEBUG] 测试非完全成功(partial_success)，准备调用AI分类
[17:41:30.849] [AI_DEBUG] 生成的txt_content长度: 18627
[17:41:30.849] [AI_DEBUG] _ai_classify_with_txt_content called:
[17:41:30.849]   - use_ai_classification=True
[17:41:30.849]   - ai_classifier=True
[17:41:30.849]   - txt_content_len=18627
[17:41:30.849]   - task_model=llama-3.3-70b-instruct
[17:41:30.849] [AI_CLASSIFIER] 直接使用AI分析完整交互记录（跳过规则匹配）
[17:41:38.348] 2025-08-20 17:41:38,347 - httpx - INFO - HTTP Request: POST https://85409-me3ofvov-eastus2.cognitiveservices.azure.com/openai/deployments/gpt-5-nano/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
[17:41:38.357] [AI_DEBUG] AI分类结果: category=dependency_errors, confidence=0.85
[17:43:18.926] 2025-08-20 17:43:18,925 - openai._base_client - INFO - Retrying request to /chat/completions in 0.453041 seconds
[17:43:19.656] 2025-08-20 17:43:19,656 - openai._base_client - INFO - Retrying request to /chat/completions in 0.496544 seconds
[17:43:19.705] 2025-08-20 17:43:19,705 - openai._base_client - INFO - Retrying request to /chat/completions in 0.392205 seconds
[17:43:20.256] 2025-08-20 17:43:20,255 - httpx - INFO - HTTP Request: POST https://85409-me3ofvov-eastus2.services.ai.azure.com/openai/deployments/Llama-3.3-70B-Instruct-2/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
[17:43:20.259]   [EARLY_EXIT] No actions taken, continuing...
[17:43:20.259] 
[17:43:20.259] [TURN 3/10]
[17:43:20.261] [LLM_CALL] Using model: Llama-3.3-70B-Instruct-2, API name: Llama-3.3-70B-Instruct-2
[17:43:20.999] 2025-08-20 17:43:20,998 - httpx - INFO - HTTP Request: POST https://85409-me3ofvov-eastus2.services.ai.azure.com/openai/deployments/Llama-3.3-70B-Instruct-2/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
[17:43:20.999]   [EARLY_EXIT] No actions taken, continuing...
[17:43:20.999] 
[17:43:20.999] [TURN 4/10]
[17:43:21.000] [LLM_CALL] Using model: Llama-3.3-70B-Instruct-2, API name: Llama-3.3-70B-Instruct-2
[17:43:21.315] 2025-08-20 17:43:21,315 - httpx - INFO - HTTP Request: POST https://85409-me3ofvov-eastus2.services.ai.azure.com/openai/deployments/Llama-3.3-70B-Instruct-2/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
[17:43:21.316]   [EARLY_EXIT] No actions taken, continuing...
[17:43:21.316] 
[17:43:21.316] [TURN 3/10]
[17:43:21.316] [LLM_CALL] Using model: Llama-3.3-70B-Instruct-2, API name: Llama-3.3-70B-Instruct-2
[17:43:21.685] 2025-08-20 17:43:21,685 - httpx - INFO - HTTP Request: POST https://85409-me3ofvov-eastus2.services.ai.azure.com/openai/deployments/Llama-3.3-70B-Instruct-2/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
[17:43:21.687]   [SEARCH] Query: network api fetch
[17:43:21.689] 
[17:43:21.689] [TURN 4/10]
[17:43:21.689] [LLM_CALL] Using model: Llama-3.3-70B-Instruct-2, API name: Llama-3.3-70B-Instruct-2
[17:43:21.870] 2025-08-20 17:43:21,870 - httpx - INFO - HTTP Request: POST https://85409-me3ofvov-eastus2.services.ai.azure.com/openai/deployments/Llama-3.3-70B-Instruct-2/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
[17:43:21.870]   [SEARCH] Query: data validation parser
[17:43:21.871] 
[17:43:21.871] [TURN 5/10]
[17:43:21.871] [LLM_CALL] Using model: Llama-3.3-70B-Instruct-2, API name: Llama-3.3-70B-Instruct-2
[17:43:21.980] 2025-08-20 17:43:21,980 - httpx - INFO - HTTP Request: POST https://85409-me3ofvov-eastus2.services.ai.azure.com/openai/deployments/Llama-3.3-70B-Instruct-2/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
[17:43:21.981]   [EARLY_EXIT] No actions taken, continuing...
[17:43:21.981] 
[17:43:21.981] [TURN 4/10]
[17:43:21.983] [LLM_CALL] Using model: Llama-3.3-70B-Instruct-2, API name: Llama-3.3-70B-Instruct-2
[17:43:22.403] 2025-08-20 17:43:22,403 - httpx - INFO - HTTP Request: POST https://85409-me3ofvov-eastus2.services.ai.azure.com/openai/deployments/Llama-3.3-70B-Instruct-2/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
[17:43:22.404]   [EARLY_EXIT] No actions taken, continuing...
[17:43:22.404] 
[17:43:22.404] [TURN 5/10]
[17:43:22.405] [LLM_CALL] Using model: Llama-3.3-70B-Instruct-2, API name: Llama-3.3-70B-Instruct-2
[17:43:22.813] 2025-08-20 17:43:22,811 - httpx - INFO - HTTP Request: POST https://85409-me3ofvov-eastus2.services.ai.azure.com/openai/deployments/Llama-3.3-70B-Instruct-2/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
[17:43:22.814]   [EARLY_EXIT] No actions taken, continuing...
[17:43:22.815] 
[17:43:22.815] [TURN 6/10]
[17:43:22.819] [LLM_CALL] Using model: Llama-3.3-70B-Instruct-2, API name: Llama-3.3-70B-Instruct-2
[17:43:23.475] 2025-08-20 17:43:23,475 - httpx - INFO - HTTP Request: POST https://85409-me3ofvov-eastus2.services.ai.azure.com/openai/deployments/Llama-3.3-70B-Instruct-2/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
[17:43:23.477]   [FORMAT_ISSUE] Turn 6: No tools executed after multiple turns
[17:43:23.477] 
[17:43:23.477] [TURN 7/10]
[17:43:23.478] [LLM_CALL] Using model: Llama-3.3-70B-Instruct-2, API name: Llama-3.3-70B-Instruct-2
[17:43:23.650] 2025-08-20 17:43:23,647 - httpx - INFO - HTTP Request: POST https://85409-me3ofvov-eastus2.services.ai.azure.com/openai/deployments/Llama-3.3-70B-Instruct-2/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
[17:43:23.652]   [PARSE] Found tool call: file_operations_reader
[17:43:23.652]   [EXECUTING] file_operations_reader
[17:43:23.652]     Result: SUCCESS
[17:43:23.653] 
[17:43:23.653] [TURN 5/10]
[17:43:23.654] [LLM_CALL] Using model: Llama-3.3-70B-Instruct-2, API name: Llama-3.3-70B-Instruct-2
[17:43:23.824] 2025-08-20 17:43:23,823 - httpx - INFO - HTTP Request: POST https://85409-me3ofvov-eastus2.services.ai.azure.com/openai/deployments/Llama-3.3-70B-Instruct-2/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
[17:43:23.826]   [INFO] Tool info request: network_fetcher
[17:43:23.826] 
[17:43:23.826] [TURN 6/10]
[17:43:23.850] [LLM_CALL] Using model: Llama-3.3-70B-Instruct-2, API name: Llama-3.3-70B-Instruct-2
[17:43:24.095] 2025-08-20 17:43:24,095 - httpx - INFO - HTTP Request: POST https://85409-me3ofvov-eastus2.services.ai.azure.com/openai/deployments/Llama-3.3-70B-Instruct-2/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
[17:43:24.096]   [FORMAT_ISSUE] Turn 7: Detected potential tool 'e' in incorrect format; Mentioned using 'data_processing_validator' but no proper tool call found; No tools executed after multiple turns
[17:43:24.096]   [FORMAT_ISSUE] Potential tools detected: ['e', 'data_processing_validator']
[17:43:24.097] 
[17:43:24.097] [TURN 8/10]
[17:43:24.103] [LLM_CALL] Using model: Llama-3.3-70B-Instruct-2, API name: Llama-3.3-70B-Instruct-2
[17:43:25.223] 2025-08-20 17:43:25,221 - httpx - INFO - HTTP Request: POST https://85409-me3ofvov-eastus2.services.ai.azure.com/openai/deployments/Llama-3.3-70B-Instruct-2/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
[17:43:25.224]   [PARSE] Found tool call: data_processing_parser
[17:43:25.224]   [EXECUTING] data_processing_parser
[17:43:25.224]     Result: FAILED - INVALID_INPUT: Input validation failed (expected: JSON format)
[17:43:25.224] 
[17:43:25.224] [TURN 9/10]
[17:43:25.226] [LLM_CALL] Using model: Llama-3.3-70B-Instruct-2, API name: Llama-3.3-70B-Instruct-2
[17:43:25.561] 2025-08-20 17:43:25,555 - httpx - INFO - HTTP Request: POST https://85409-me3ofvov-eastus2.services.ai.azure.com/openai/deployments/Llama-3.3-70B-Instruct-2/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
[17:43:25.562]   [PARSE] Found tool call: data_processing_parser
[17:43:25.562]   [EXECUTING] data_processing_parser
[17:43:25.562]     Result: SUCCESS
[17:43:25.562] 
[17:43:25.562] [TURN 6/10]
[17:43:25.574] [LLM_CALL] Using model: Llama-3.3-70B-Instruct-2, API name: Llama-3.3-70B-Instruct-2
[17:43:25.610] 2025-08-20 17:43:25,609 - httpx - INFO - HTTP Request: POST https://85409-me3ofvov-eastus2.services.ai.azure.com/openai/deployments/Llama-3.3-70B-Instruct-2/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
[17:43:25.613]   [PARSE] Found tool call: network_fetcher
[17:43:25.613]   [EXECUTING] network_fetcher
[17:43:25.613]     Result: SUCCESS
[17:43:25.613] 
[17:43:25.613] [TURN 7/10]
[17:43:25.616] [LLM_CALL] Using model: Llama-3.3-70B-Instruct-2, API name: Llama-3.3-70B-Instruct-2
[17:43:25.895] 2025-08-20 17:43:25,894 - httpx - INFO - HTTP Request: POST https://85409-me3ofvov-eastus2.services.ai.azure.com/openai/deployments/Llama-3.3-70B-Instruct-2/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
[17:43:25.896]   [FORMAT_ISSUE] Turn 9: Mentioned using 'data_processing_parser' but no proper tool call found
[17:43:25.896]   [FORMAT_ISSUE] Potential tools detected: ['data_processing_parser']
[17:43:25.897] 
[17:43:25.897] [TURN 10/10]
[17:43:25.898] [LLM_CALL] Using model: Llama-3.3-70B-Instruct-2, API name: Llama-3.3-70B-Instruct-2
[17:43:26.498] 2025-08-20 17:43:26,497 - httpx - INFO - HTTP Request: POST https://85409-me3ofvov-eastus2.services.ai.azure.com/openai/deployments/Llama-3.3-70B-Instruct-2/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
[17:43:26.500]   [FORMAT_ISSUE] Turn 7: Detected potential tool 'y' in incorrect format
[17:43:26.500]   [FORMAT_ISSUE] Potential tools detected: ['y']
[17:43:26.500] 
[17:43:26.500] [TURN 8/10]
[17:43:26.510] [LLM_CALL] Using model: Llama-3.3-70B-Instruct-2, API name: Llama-3.3-70B-Instruct-2
[17:43:26.637] 2025-08-20 17:43:26,636 - httpx - INFO - HTTP Request: POST https://85409-me3ofvov-eastus2.services.ai.azure.com/openai/deployments/Llama-3.3-70B-Instruct-2/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
[17:43:26.639]   [PARSE] Found tool call: data_processing_validator
[17:43:26.640]   [EXECUTING] data_processing_validator
[17:43:26.640]     [DEPENDENCY] Failed: data_processing_parser, success rate reduced
[17:43:26.640]     Result: FAILED - INVALID_INPUT: Input validation failed (expected: CSV format)
[17:43:26.640] [ASSISTED] Task received 3 format helps, final result: failure
[17:43:26.641] [DEBUG RAG] data_processing_transformer semantically matched with data_processing_parser (score: 0.742)
[17:43:26.641] [DEBUG RAG] data_processing_transformer semantically matched with data_processing_validator (score: 0.617)
[17:43:26.641] [DEBUG RAG] data_processing_filter semantically matched with data_processing_parser (score: 0.684)
[17:43:26.641] [DEBUG RAG] data_processing_filter semantically matched with data_processing_validator (score: 0.628)
[17:43:26.641] [DEBUG] Got result for task: has_result=True, save_logs=True
[17:43:26.641] [AI_DEBUG] 测试非完全成功(partial_success)，准备调用AI分类
[17:43:26.642] [AI_DEBUG] 生成的txt_content长度: 15211
[17:43:26.642] [AI_DEBUG] _ai_classify_with_txt_content called:
[17:43:26.642]   - use_ai_classification=True
[17:43:26.642]   - ai_classifier=True
[17:43:26.642]   - txt_content_len=15211
[17:43:26.642]   - task_model=llama-3.3-70b-instruct
[17:43:26.642] [AI_CLASSIFIER] 直接使用AI分析完整交互记录（跳过规则匹配）
[17:43:26.928] 2025-08-20 17:43:26,927 - httpx - INFO - HTTP Request: POST https://85409-me3ofvov-eastus2.services.ai.azure.com/openai/deployments/Llama-3.3-70B-Instruct-2/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
[17:43:26.932]   [PARSE] Found tool call: data_processing_filter
[17:43:26.932]   [EXECUTING] data_processing_filter
[17:43:26.932]     Result: SUCCESS
[17:43:26.932] 
[17:43:26.932] [TURN 7/10]
[17:43:26.937] [LLM_CALL] Using model: Llama-3.3-70B-Instruct-2, API name: Llama-3.3-70B-Instruct-2
[17:43:27.256] 2025-08-20 17:43:27,255 - httpx - INFO - HTTP Request: POST https://85409-me3ofvov-eastus2.services.ai.azure.com/openai/deployments/Llama-3.3-70B-Instruct-2/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
[17:43:27.257]   [FORMAT_ISSUE] Turn 8: Detected potential tool 'y' in incorrect format
[17:43:27.257]   [FORMAT_ISSUE] Potential tools detected: ['y']
[17:43:27.257] 
[17:43:27.257] [TURN 9/10]
[17:43:27.257] [LLM_CALL] Using model: Llama-3.3-70B-Instruct-2, API name: Llama-3.3-70B-Instruct-2
[17:43:28.108] 2025-08-20 17:43:28,108 - httpx - INFO - HTTP Request: POST https://85409-me3ofvov-eastus2.services.ai.azure.com/openai/deployments/Llama-3.3-70B-Instruct-2/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
[17:43:28.109]   [FORMAT_ISSUE] Turn 9: Detected potential tool 'y' in incorrect format
[17:43:28.109]   [FORMAT_ISSUE] Potential tools detected: ['y']
[17:43:28.109] 
[17:43:28.109] [TURN 10/10]
[17:43:28.110] [LLM_CALL] Using model: Llama-3.3-70B-Instruct-2, API name: Llama-3.3-70B-Instruct-2
[17:43:28.322] 2025-08-20 17:43:28,321 - httpx - INFO - HTTP Request: POST https://85409-me3ofvov-eastus2.services.ai.azure.com/openai/deployments/Llama-3.3-70B-Instruct-2/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
[17:43:28.323]   [PARSE] Found tool call: computation_calculator
[17:43:28.323]   [EXECUTING] computation_calculator
[17:43:28.324]     [DEPENDENCY] Missing: network_validator, success rate reduced
[17:43:28.324]     Result: SUCCESS
[17:43:28.324] 
[17:43:28.325] [TURN 8/10]
[17:43:28.325] [LLM_CALL] Using model: Llama-3.3-70B-Instruct-2, API name: Llama-3.3-70B-Instruct-2
[17:43:29.136] 2025-08-20 17:43:29,136 - httpx - INFO - HTTP Request: POST https://85409-me3ofvov-eastus2.services.ai.azure.com/openai/deployments/Llama-3.3-70B-Instruct-2/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
[17:43:29.138]   [FORMAT_ISSUE] Turn 8: Detected potential tool 'y' in incorrect format; Mentioned using 'computation_calculator' but no proper tool call found
[17:43:29.138]   [FORMAT_ISSUE] Potential tools detected: ['y', 'computation_calculator']
[17:43:29.138] 
[17:43:29.138] [TURN 9/10]
[17:43:29.140] [LLM_CALL] Using model: Llama-3.3-70B-Instruct-2, API name: Llama-3.3-70B-Instruct-2
[17:43:29.382] 2025-08-20 17:43:29,382 - httpx - INFO - HTTP Request: POST https://85409-me3ofvov-eastus2.services.ai.azure.com/openai/deployments/Llama-3.3-70B-Instruct-2/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
[17:43:29.386]   [PARSE] Found tool call: data_processing_validator
[17:43:29.386]   [EXECUTING] data_processing_validator
[17:43:29.386]     [DEPENDENCY] Missing: data_processing_parser, success rate reduced
[17:43:29.386]     Result: SUCCESS
[17:43:29.386] [ASSISTED] Task received 3 format helps, final result: failure
[17:43:29.387] [DEBUG RAG] data_processing_parser semantically matched with data_processing_validator (score: 0.625)
[17:43:29.387] [DEBUG RAG] network_poster semantically matched with network_fetcher (score: 0.627)
[17:43:30.002] 2025-08-20 17:43:29,998 - httpx - INFO - HTTP Request: POST https://85409-me3ofvov-eastus2.services.ai.azure.com/openai/deployments/Llama-3.3-70B-Instruct-2/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
[17:43:30.007]   [FORMAT_ISSUE] Turn 9: Detected potential tool 'y' in incorrect format; Mentioned using 'computation_calculator' but no proper tool call found
[17:43:30.007]   [FORMAT_ISSUE] Potential tools detected: ['y', 'computation_calculator']
[17:43:30.007] 
[17:43:30.007] [TURN 10/10]
[17:43:30.007] [LLM_CALL] Using model: Llama-3.3-70B-Instruct-2, API name: Llama-3.3-70B-Instruct-2
[17:43:31.212] 2025-08-20 17:43:31,211 - httpx - INFO - HTTP Request: POST https://85409-me3ofvov-eastus2.services.ai.azure.com/openai/deployments/Llama-3.3-70B-Instruct-2/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
[17:43:31.213]   [PARSE] Found tool call: data_processing_aggregator
[17:43:31.213]   [EXECUTING] data_processing_aggregator
[17:43:31.215]     Result: SUCCESS
[17:43:31.215] [ASSISTED] Task received 2 format helps, final result: full_success
[17:43:34.883] 2025-08-20 17:43:34,882 - httpx - INFO - HTTP Request: POST https://85409-me3ofvov-eastus2.cognitiveservices.azure.com/openai/deployments/gpt-5-nano/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
[17:43:34.889] [AI_DEBUG] AI分类结果: category=parameter_config_errors, confidence=0.85
[17:43:34.904] [DEBUG] Got result for task: has_result=True, save_logs=True
[17:43:34.904] [AI_DEBUG] 测试非完全成功(partial_success)，准备调用AI分类
[17:43:34.904] [AI_DEBUG] 生成的txt_content长度: 18083
[17:43:34.904] [AI_DEBUG] _ai_classify_with_txt_content called:
[17:43:34.904]   - use_ai_classification=True
[17:43:34.905]   - ai_classifier=True
[17:43:34.905]   - txt_content_len=18083
[17:43:34.905]   - task_model=llama-3.3-70b-instruct
[17:43:34.905] [AI_CLASSIFIER] 直接使用AI分析完整交互记录（跳过规则匹配）
[17:43:40.459] 2025-08-20 17:43:40,459 - httpx - INFO - HTTP Request: POST https://85409-me3ofvov-eastus2.cognitiveservices.azure.com/openai/deployments/gpt-5-nano/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
[17:43:40.460] [AI_DEBUG] AI分类结果: category=dependency_errors, confidence=0.85
[17:43:40.468] [DEBUG] Got result for task: has_result=True, save_logs=True
[17:43:40.471] 
[17:43:40.471] [INFO] Batch writing 5 records to database (llama-3.3-70b-instruct:5)
[17:43:40.471] 2025-08-20 17:43:40,471 - batch_test_runner - INFO - Batch writing 5 records to database (llama-3.3-70b-instruct:5)
[17:43:40.472] [INFO] Successfully wrote 5/5 records (llama-3.3-70b-instruct:5)
[17:43:40.472] 2025-08-20 17:43:40,472 - batch_test_runner - INFO - Successfully wrote 5/5 records (llama-3.3-70b-instruct:5)
[17:43:40.472] [INFO] 数据已同步到Parquet存储
[17:43:40.472] 2025-08-20 17:43:40,472 - batch_test_runner - INFO - Database saved successfully
[17:43:40.473] 2025-08-20 17:43:40,473 - batch_test_runner - INFO - ============================================================
[17:43:40.473] 2025-08-20 17:43:40,473 - batch_test_runner - INFO - Batch test completed at 2025-08-20T17:43:40.473104
[17:43:40.473] 2025-08-20 17:43:40,473 - batch_test_runner - INFO - Summary:
[17:43:40.473] 2025-08-20 17:43:40,473 - batch_test_runner - INFO -   - Total tests: 5
[17:43:40.473] 2025-08-20 17:43:40,473 - batch_test_runner - INFO -   - Successful: 5
[17:43:40.473] 2025-08-20 17:43:40,473 - batch_test_runner - INFO -   - Failed: 0
[17:43:40.473] 2025-08-20 17:43:40,473 - batch_test_runner - INFO -   - Success rate: 100.0%
[17:43:40.473] 2025-08-20 17:43:40,473 - batch_test_runner - INFO -   - Log file: logs/batch_test_20250820_174113.log
[17:43:40.473] 2025-08-20 17:43:40,473 - batch_test_runner - INFO - ============================================================
[17:43:40.473] 
[17:43:40.473] ✅ 批测试完成
[17:43:40.473]    成功: 5/5
[17:43:40.473]    失败: 0/5
[17:43:40.473] 
[17:43:40.473] 📤 最终保存5个测试结果...
[17:43:40.473] [DEBUG] 创建新的manager实例: key=True_
[17:43:40.474] ✅ 已保存 5 个测试结果到数据库
[17:43:40.607] [INFO] 已将 5 个汇总写入Parquet
[17:43:40.661] [INFO] 刷新manager缓存: key=True_

==================================================
分片 Llama-3.3-70B-Instruct_easy_1 完成
退出码: 0
总行数: 654
运行时间: 152.0秒
时间: 2025-08-20T17:43:41.951072
