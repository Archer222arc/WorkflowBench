# ğŸš€ å¹¶å‘ä¼˜åŒ–ç­–ç•¥æ€»ç»“

ç”Ÿæˆæ—¶é—´: 2025-08-19 19:50
ä½œè€…: Claude Assistant

## ğŸ“Š å¹¶å‘å±‚çº§æ¦‚è§ˆ

ç³»ç»Ÿå®ç°äº†å¤šå±‚çº§çš„å¹¶å‘ä¼˜åŒ–ï¼Œä»APIæä¾›å•†çº§åˆ«åˆ°å…·ä½“çš„ä»»åŠ¡åˆ†ç‰‡çº§åˆ«ï¼š

```
Level 1: APIæä¾›å•†å¹¶å‘ (Azure vs IdealLab)
    â”œâ”€â”€ Level 2: æ¨¡å‹å®ä¾‹å¹¶å‘ (å¤šä¸ªdeployment)
    â”‚   â”œâ”€â”€ Level 3: API Keyå¹¶å‘ (IdealLabçš„3ä¸ªkeys)
    â”‚   â”‚   â””â”€â”€ Level 4: Workerå¹¶å‘ (æ¯ä¸ªå®ä¾‹çš„max_workers)
    â”‚   â””â”€â”€ Level 4: Workerå¹¶å‘ (Azureçš„é«˜å¹¶å‘)
    â””â”€â”€ Level 2: è·¨æ¨¡å‹å¹¶å‘ (ä¸åŒæ¨¡å‹åŒæ—¶æµ‹è¯•)
```

## 1ï¸âƒ£ Azureå¼€æºæ¨¡å‹å¹¶å‘ç­–ç•¥

### 1.1 DeepSeekç³»åˆ—ï¼ˆ6ä¸ªå®ä¾‹ï¼‰
```python
# DeepSeek-V3-0324
- DeepSeek-V3-0324    (ä¸»å®ä¾‹)
- DeepSeek-V3-0324-2  (å¹¶è¡Œå®ä¾‹)
- DeepSeek-V3-0324-3  (å¹¶è¡Œå®ä¾‹)

# DeepSeek-R1-0528
- DeepSeek-R1-0528    (ä¸»å®ä¾‹)
- DeepSeek-R1-0528-2  (å¹¶è¡Œå®ä¾‹)
- DeepSeek-R1-0528-3  (å¹¶è¡Œå®ä¾‹)
```

**å¹¶å‘é…ç½®**:
- æ¯ä¸ªå®ä¾‹: max_workers=100, QPS=200
- æ€»å¹¶å‘èƒ½åŠ›: 3ä¸ªå®ä¾‹ Ã— 100 workers = **300å¹¶å‘**
- ç­–ç•¥: ä»»åŠ¡åˆ†ç‰‡åˆ°3ä¸ªå®ä¾‹å¹¶è¡Œæ‰§è¡Œ

### 1.2 Llamaç³»åˆ—ï¼ˆ3ä¸ªå®ä¾‹ï¼‰
```python
# Llama-3.3-70B-Instruct
- Llama-3.3-70B-Instruct    (ä¸»å®ä¾‹)
- Llama-3.3-70B-Instruct-2  (å¹¶è¡Œå®ä¾‹)
- Llama-3.3-70B-Instruct-3  (å¹¶è¡Œå®ä¾‹)
```

**å¹¶å‘é…ç½®**:
- æ¯ä¸ªå®ä¾‹: max_workers=100, QPS=200
- æ€»å¹¶å‘èƒ½åŠ›: 3ä¸ªå®ä¾‹ Ã— 100 workers = **300å¹¶å‘**

## 2ï¸âƒ£ IdealLabå¼€æºæ¨¡å‹å¹¶å‘ç­–ç•¥ï¼ˆqwenç³»åˆ—ï¼‰

### 2.1 è™šæ‹Ÿå®ä¾‹æœºåˆ¶
```python
# 3ä¸ªè™šæ‹Ÿå®ä¾‹å¯¹åº”3ä¸ªAPI keys
- qwen-key0  (API Key 0)
- qwen-key1  (API Key 1)
- qwen-key2  (API Key 2)
```

### 2.2 ç»Ÿä¸€åˆ†ç‰‡ç­–ç•¥ï¼ˆæœ€ç»ˆç®€åŒ–ç‰ˆï¼‰

#### æ‰€æœ‰åœºæ™¯ç»Ÿä¸€å¤„ç†
```
å‡åŒ€åˆ†é…ç­–ç•¥:
- æ‰€æœ‰ä»»åŠ¡å‡åŒ€åˆ†é…åˆ°3ä¸ªkeys
- ä¸ç®¡æ˜¯ä»€ä¹ˆåœºæ™¯ï¼ˆ5.1/5.2/5.3/5.4/5.5ï¼‰
- æ¯ä¸ªkeyè´Ÿè´£1/3çš„ä»»åŠ¡é‡
æ•ˆæœ: æè‡´ç®€åŒ–ï¼Œ3å€å¹¶å‘æå‡
```

å…·ä½“åº”ç”¨ï¼š
- **5.1/5.2åŸºå‡†æµ‹è¯•**ï¼šoptimalä»»åŠ¡ â†’ å‡åŒ€åˆ†é…
- **5.3ç¼ºé™·æµ‹è¯•**ï¼š7ä¸ªflawed â†’ å‡åŒ€åˆ†é…
- **5.4å·¥å…·å¯é æ€§**ï¼šä¸åŒrate â†’ å‡åŒ€åˆ†é…ï¼ˆrateå±‚æ¬¡ä¸²è¡Œï¼‰
- **5.5æç¤ºæ•æ„Ÿæ€§**ï¼šbaseline/cot/optimal â†’ å‡åŒ€åˆ†é…

**å¹¶å‘é…ç½®**:
- æ¯ä¸ªkey: max_workers=3-5ï¼ˆè‡ªé€‚åº”æ¨¡å¼5ï¼Œå›ºå®šæ¨¡å¼3ï¼‰
- æ€»å¹¶å‘èƒ½åŠ›: 3ä¸ªkeys Ã— 5 workers = **15å¹¶å‘**
- ç‰¹æ€§: ä¸åŒæ¨¡å‹é—´é€Ÿç‡ç‹¬ç«‹ï¼Œå¯åŒæ—¶æµ‹è¯•å¤šä¸ªqwenæ¨¡å‹

## 3ï¸âƒ£ Azureé—­æºæ¨¡å‹å¹¶å‘ç­–ç•¥

### 3.1 æ”¯æŒçš„æ¨¡å‹
- gpt-4o-mini
- gpt-5-mini

**å¹¶å‘é…ç½®**:
- å•deploymentç­–ç•¥ï¼šè™½ç„¶åªæœ‰1ä¸ªå®ä¾‹ï¼Œä½†æ”¯æŒé«˜å¹¶å‘
- max_workers=200ï¼ˆè‡ªé€‚åº”æ¨¡å¼ï¼‰
- å¤špromptå¹¶å‘ï¼šå¦‚æœæœ‰Nä¸ªprompt typesï¼Œworkers = 200 Ã— N
- ä¾‹å¦‚ï¼š3ä¸ªprompt types = 600ä¸ªworkers

## 4ï¸âƒ£ IdealLabé—­æºæ¨¡å‹å¹¶å‘ç­–ç•¥

### 4.1 æ”¯æŒçš„æ¨¡å‹
- o3-0416-global
- gemini-2.5-flash-06-17
- kimi-k2
- claude_sonnet4

**å¹¶å‘é…ç½®**:
- å•API Keyé™åˆ¶ï¼šåªèƒ½ä½¿ç”¨1ä¸ªkey
- max_workers=1ï¼ˆä¿å®ˆè®¾ç½®é¿å…é™æµï¼‰
- QPS=5-10
- ç­–ç•¥ï¼šä¸²è¡Œæ‰§è¡Œï¼Œç¨³å®šæ€§ä¼˜å…ˆ

## 5ï¸âƒ£ å¤šå±‚çº§å¹¶å‘ç¤ºä¾‹

### å®Œæ•´çš„å¹¶å‘æ‰§è¡Œæµç¨‹
```
ultra_parallel_runner.py
â”œâ”€â”€ æ£€æµ‹æ¨¡å‹ç±»å‹
â”œâ”€â”€ åˆ›å»ºä»»åŠ¡åˆ†ç‰‡
â”‚   â”œâ”€â”€ Azureå¼€æº: åˆ†3ä¸ªå®ä¾‹
â”‚   â”œâ”€â”€ IdealLabå¼€æº(qwen): æ™ºèƒ½åˆ†é…åˆ°3ä¸ªkeys
â”‚   â”œâ”€â”€ Azureé—­æº: å•å®ä¾‹é«˜å¹¶å‘
â”‚   â””â”€â”€ IdealLabé—­æº: å•å®ä¾‹ä¿å®ˆå¹¶å‘
â””â”€â”€ å¹¶è¡Œæ‰§è¡Œæ‰€æœ‰åˆ†ç‰‡
    â”œâ”€â”€ åˆ†ç‰‡1 â†’ smart_batch_runner â†’ batch_test_runner
    â”œâ”€â”€ åˆ†ç‰‡2 â†’ smart_batch_runner â†’ batch_test_runner
    â””â”€â”€ åˆ†ç‰‡3 â†’ smart_batch_runner â†’ batch_test_runner
```

## 6ï¸âƒ£ å¹¶å‘æ€§èƒ½å¯¹æ¯”

| æ¨¡å‹ç±»å‹ | å®ä¾‹/Keys | Workers/å®ä¾‹ | æ€»å¹¶å‘ | ä¼˜åŒ–æ•ˆæœ |
|---------|-----------|--------------|--------|----------|
| **Azureå¼€æº** | 3ä¸ªå®ä¾‹ | 100 | 300 | 3å€æå‡ |
| **IdealLabå¼€æº(qwen)** | 3ä¸ªkeys | 5 | 15 | 3å€æå‡ |
| **Azureé—­æº** | 1ä¸ªå®ä¾‹ | 200+ | 200-600 | è¶…é«˜å¹¶å‘ |
| **IdealLabé—­æº** | 1ä¸ªkey | 1 | 1 | ç¨³å®šä¼˜å…ˆ |

## 7ï¸âƒ£ ç‰¹æ®Šä¼˜åŒ–æŠ€å·§

### 7.1 é”™å¼€å¯åŠ¨ç­–ç•¥
é¿å…workflowç”Ÿæˆå†²çªï¼š
- ç¬¬1ä¸ªåˆ†ç‰‡ï¼šç«‹å³å¯åŠ¨
- ç¬¬2ä¸ªåˆ†ç‰‡ï¼šå»¶è¿Ÿ30ç§’
- ç¬¬3ä¸ªåˆ†ç‰‡ï¼šå»¶è¿Ÿ20ç§’

### 7.2 Promptå¹¶å‘å€å¢
å¯¹äºå¤špromptåœºæ™¯ï¼š
```python
if prompt_count > 1:
    max_workers = base_workers * prompt_count
    # ä¾‹å¦‚: 3ä¸ªprompts Ã— 100 base = 300 workers
```

### 7.3 è‡ªé€‚åº”é€Ÿç‡æ§åˆ¶
- adaptiveæ¨¡å¼ï¼šåŠ¨æ€è°ƒæ•´QPSï¼Œæ— ä¸Šé™
- fixedæ¨¡å¼ï¼šå›ºå®šQPSï¼Œä¿å®ˆç­–ç•¥

## 8ï¸âƒ£ ç¯å¢ƒå˜é‡æ§åˆ¶

```bash
# é€‰æ‹©é€Ÿç‡æ¨¡å¼
export RATE_MODE=adaptive  # æˆ– fixed

# é€‰æ‹©å­˜å‚¨æ ¼å¼
export STORAGE_FORMAT=parquet  # æˆ– json

# è°ƒè¯•ç‰¹å®šè¿›ç¨‹
export DEBUG_LOG=true
export DEBUG_PROCESS_NUM=1
```

## 9ï¸âƒ£ å‘½ä»¤è¡Œç¤ºä¾‹

### åŸºç¡€æµ‹è¯•ï¼ˆè‡ªåŠ¨å¹¶å‘ï¼‰
```bash
python ultra_parallel_runner.py \
  --model qwen2.5-72b-instruct \
  --prompt-types optimal \
  --num-instances 60 \
  --rate-mode adaptive
```

### 5.4åœºæ™¯ï¼ˆå·¥å…·å¯é æ€§æµ‹è¯•ï¼‰
```bash
# æ¯ä¸ªrateå‡åŒ€ä½¿ç”¨3ä¸ªkeysï¼ˆä¸5.1/5.2ç›¸åŒï¼‰
python ultra_parallel_runner.py \
  --model qwen2.5-72b-instruct \
  --prompt-types optimal \
  --tool-success-rate 0.9  # å‡åŒ€åˆ†é…åˆ°3ä¸ªkeys
```

### 5.3åœºæ™¯ï¼ˆflawedæµ‹è¯•ï¼‰
```bash
# è‡ªåŠ¨åˆ†é…åˆ°3ä¸ªkeys
python ultra_parallel_runner.py \
  --model qwen2.5-72b-instruct \
  --prompt-types flawed_sequence_disorder,flawed_tool_misuse,flawed_parameter_error
```

## ğŸ¯ æ€»ç»“

ç³»ç»Ÿå®ç°äº†**4ä¸ªå±‚çº§**çš„å¹¶å‘ä¼˜åŒ–ï¼š

1. **APIæä¾›å•†çº§**ï¼šAzureå’ŒIdealLabå¹¶è¡Œ
2. **æ¨¡å‹å®ä¾‹çº§**ï¼šå¤šdeployment/å¤škeyå¹¶è¡Œ
3. **ä»»åŠ¡åˆ†ç‰‡çº§**ï¼šæ™ºèƒ½åˆ†é…ç­–ç•¥
4. **Workerçº§**ï¼šæ¯ä¸ªå®ä¾‹çš„å¹¶å‘workers

**å…³é”®æˆæœ**ï¼š
- Azureå¼€æºæ¨¡å‹ï¼š3å€æå‡ï¼ˆåˆ©ç”¨3ä¸ªdeploymentsï¼‰
- IdealLabå¼€æºæ¨¡å‹(qwen)ï¼š3å€æå‡ï¼ˆåˆ©ç”¨3ä¸ªAPI keysï¼‰
- Azureé—­æºæ¨¡å‹ï¼šè¶…é«˜å¹¶å‘ï¼ˆå•å®ä¾‹200+ workersï¼‰
- IdealLabé—­æºæ¨¡å‹ï¼šç¨³å®šæ‰§è¡Œï¼ˆå•keyé™åˆ¶ï¼‰

**æ™ºèƒ½ä¼˜åŒ–**ï¼š
- 5.1-5.5æ‰€æœ‰åœºæ™¯éƒ½æœ‰ä¸“é—¨çš„ä¼˜åŒ–ç­–ç•¥
- é¿å…èµ„æºæµªè´¹å’Œkeyæ‹¥å µ
- æœ€å¤§åŒ–åˆ©ç”¨å¯ç”¨èµ„æº

---
æ–‡æ¡£ç‰ˆæœ¬: 1.0.0
æœ€åæ›´æ–°: 2025-08-19 19:50