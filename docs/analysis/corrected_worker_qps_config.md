# Ultraå¹¶å‘Workerå’ŒQPSé…ç½®ä¿®æ­£æ€»ç»“

## âœ… **ä¿®æ­£å†…å®¹**

### **1. ç»Ÿä¸€éè‡ªé€‚åº”æ¨¡å¼Workeræ•°é…ç½®**

| APIç±»å‹ | ä¿®æ­£å‰ | ä¿®æ­£å | ä¿®æ­£ä½ç½® |
|---------|--------|--------|----------|
| **Azureå¼€æº** | smart_batch_runner.py: 100 | **50** | smart_batch_runner.py:378 |
| **IdealLabå¼€æº** | ultra_parallel_runner.py: 3 | **2** | ultra_parallel_runner.py:337 |

### **2. ç§»é™¤æ‰€æœ‰QPSä¸Šé™é™åˆ¶**

æ‰€æœ‰APIç±»å‹çš„QPSè®¾ç½®ç»Ÿä¸€æ”¹ä¸º `None`ï¼ˆæ— é™åˆ¶ï¼‰:

#### **ultra_parallel_runner.py ä¿®æ­£**:
```python
# ä¿®æ­£å‰æœ‰å„ç§QPSé™åˆ¶ï¼š
qps = 10, qps = 5, qps = 100, qps = 200, etc.

# ä¿®æ­£åå…¨éƒ¨ç§»é™¤ï¼š
qps = None  # ç§»é™¤QPSé™åˆ¶
```

#### **smart_batch_runner.py ä¿®æ­£**:
```python  
# ä¿®æ­£å‰ï¼š
qps = 5.0, qps = 10.0, qps = 200.0

# ä¿®æ­£åï¼š
qps = None  # ç§»é™¤QPSé™åˆ¶
```

## ğŸ¯ **ä¿®æ­£åçš„å®Œæ•´é…ç½®è¡¨**

### **ultra_parallel_runner.py é…ç½®**

| æ¨¡å‹ç±»å‹ | æ¨¡å¼ | Workers | QPS | å¤‡æ³¨ |
|---------|------|---------|-----|------|
| **Qwen (IdealLabå¼€æº)** | Fixed | 2 | None | âœ… ä¿®æ­£ï¼š3â†’2 |
| **Qwen (IdealLabå¼€æº)** | Adaptive | 1 | None | ä¿æŒä¸å˜ |
| **Azureå¼€æº** | Fixed | 50 | None | âœ… å·²æ­£ç¡® |
| **Azureå¼€æº** | Adaptive | 100 | None | ä¿æŒä¸å˜ |
| **Azureé—­æº** | Fixed | 100 | None | âœ… ç§»é™¤QPSé™åˆ¶ |
| **Azureé—­æº** | Adaptive | 200 | None | ä¿æŒä¸å˜ |
| **IdealLabé—­æº** | Fixed | 1 | None | âœ… ç§»é™¤QPSé™åˆ¶ |
| **IdealLabé—­æº** | Adaptive | 1 | None | ä¿æŒä¸å˜ |

### **smart_batch_runner.py é…ç½®**

| æ¨¡å‹ç±»å‹ | æ¨¡å¼ | Workers | QPS | å¤‡æ³¨ |
|---------|------|---------|-----|------|
| **IdealLab API** | Adaptive | 5 | None | âœ… ç§»é™¤QPSé™åˆ¶ |
| **IdealLab API** | Fixed | 2 | None | âœ… ç§»é™¤QPSé™åˆ¶ |
| **Azure API** | Adaptive | 100 | None | âœ… ç§»é™¤QPSé™åˆ¶ |
| **Azure API** | Fixed | 50 | None | âœ… ä¿®æ­£ï¼š100â†’50 |

## ğŸ“Š **ä¿®æ­£åçš„å®é™…å¹¶å‘æ•°**

### **éè‡ªé€‚åº”æ¨¡å¼ï¼ˆFixed Modeï¼‰æ€»å¹¶å‘**:

#### **Azureå¼€æºæ¨¡å‹** (DeepSeek-V3, DeepSeek-R1, Llama-3.3):
```
50 workers/å®ä¾‹ Ã— 3ä¸ªå®ä¾‹ = 150 total concurrent workers
æ— QPSé™åˆ¶ = æ— é™åˆ¶è°ƒç”¨é€Ÿåº¦
```

#### **Qwenæ¨¡å‹** (IdealLabå¼€æº):
```  
2 workers/key Ã— 3ä¸ªkeys = 6 total concurrent workers
æ— QPSé™åˆ¶ = æ— é™åˆ¶è°ƒç”¨é€Ÿåº¦
```

#### **Azureé—­æºæ¨¡å‹** (gpt-4o-mini, gpt-5-mini):
```
100 workers/å®ä¾‹ Ã— 1ä¸ªå®ä¾‹ = 100 total concurrent workers
æ— QPSé™åˆ¶ = æ— é™åˆ¶è°ƒç”¨é€Ÿåº¦
```

#### **IdealLabé—­æºæ¨¡å‹** (o3, gemini, kimi):
```
1 worker/å®ä¾‹ Ã— 1ä¸ªå®ä¾‹ = 1 total concurrent worker  
æ— QPSé™åˆ¶ = æ— é™åˆ¶è°ƒç”¨é€Ÿåº¦
```

## ğŸ¯ **é…ç½®ä¸€è‡´æ€§éªŒè¯**

### âœ… **ç°åœ¨ä¸¤ä¸ªæ–‡ä»¶çš„é…ç½®å®Œå…¨ä¸€è‡´**:

1. **Azureéè‡ªé€‚åº”**: ultra_parallel_runner.py(50) = smart_batch_runner.py(50) 
2. **IdealLabéè‡ªé€‚åº”**: ultra_parallel_runner.py(2) = smart_batch_runner.py(2)
3. **QPSé™åˆ¶**: æ‰€æœ‰åœ°æ–¹éƒ½ç»Ÿä¸€è®¾ç½®ä¸º `None`

### âœ… **ç¬¦åˆæ‚¨çš„è¦æ±‚**:
- Azureéè‡ªé€‚åº”æ¨¡å¼: **50 workers** âœ“
- IdealLabéè‡ªé€‚åº”æ¨¡å¼: **2 workers** âœ“  
- æ— QPSä¸Šé™é™åˆ¶: **qps = None** âœ“

## ğŸš€ **æ€§èƒ½å½±å“é¢„ä¼°**

### **ç›¸æ¯”ä¿®æ­£å‰çš„å˜åŒ–**:

1. **Azure APIå¹¶å‘é™ä½**: 100â†’50 workers (é™ä½50%)
   - **ä¼˜åŠ¿**: æ›´ç¨³å®šï¼Œé¿å…APIè¿‡è½½
   - **å½±å“**: å•å®ä¾‹å¹¶å‘ç•¥é™ï¼Œä½†3å®ä¾‹æ€»è®¡ä»æœ‰150å¹¶å‘

2. **IdealLab APIå¹¶å‘é™ä½**: 3â†’2 workers (é™ä½33%)
   - **ä¼˜åŠ¿**: æ›´å¥½åœ°é¿å…IdealLab APIé™æµ
   - **å½±å“**: è½»å¾®é™ä½ï¼Œä½†3ä¸ªkeyæ€»è®¡ä»æœ‰6å¹¶å‘

3. **QPSæ— é™åˆ¶**: æ‰€æœ‰é™åˆ¶ç§»é™¤
   - **ä¼˜åŠ¿**: æœ€å¤§åŒ–APIè°ƒç”¨é€Ÿåº¦ï¼Œæ— äººä¸ºç“¶é¢ˆ
   - **å½±å“**: ä¾èµ–APIæä¾›å•†çš„è‡ªç„¶é™åˆ¶

### **é¢„æœŸç»“æœ**:
- æ›´ç¨³å®šçš„æµ‹è¯•æ‰§è¡Œ
- å‡å°‘APIè¶…æ—¶å’Œé™æµé”™è¯¯  
- ä¿æŒé«˜æ•ˆçš„æ€»ä½“å¹¶å‘èƒ½åŠ›
- æ›´ä¸€è‡´çš„é…ç½®ç®¡ç†