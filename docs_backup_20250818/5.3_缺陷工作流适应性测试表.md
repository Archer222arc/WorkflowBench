# 5.3 缺陷工作流适应性测试表 (对应计划4.3.1)

## 测试配置
- **Prompt类型**: 7种缺陷类型
  - `flawed_sequence_disorder` (顺序错误)
  - `flawed_tool_misuse` (工具误用)
  - `flawed_parameter_error` (参数错误)
  - `flawed_missing_step` (缺失步骤)
  - `flawed_redundant_operations` (冗余操作)
  - `flawed_logical_inconsistency` (逻辑不连续)
  - `flawed_semantic_drift` (语义漂移)
- **难度**: `easy`
- **工具成功率**: `0.8`（默认）
- **任务类型**: 全部5种
- **每种任务类型**: 20个实例
- **每种缺陷类型总测试数**: 100个测试/模型
- **总测试数**: 700个测试/模型（7种缺陷 × 100个测试）

## 4.3.1 缺陷工作流适应性表

### 开源模型部分

| 模型名称 | 顺序错误纠正率 | 工具误用纠正率 | 参数错误纠正率 | 缺失步骤补全率 | 冗余操作识别率 | 逻辑不连续修复率 | 语义漂移纠正率 | 平均适应性得分 |
|---------|-------------|-------------|-------------|-------------|-------------|--------------|-------------|-------------|
| **DeepSeek-V3-0324** | 95.0% | 24.4% | 100.0% | 100.0% | 100.0% | - | - | 74.5% |
| **DeepSeek-R1-0528** | - | - | - | - | - | - | - | - |
| **qwen2.5-72b-instruct** | 0.0% | 0.0% | 0.0% | - | - | - | - | 0.0% |
| **qwen2.5-32b-instruct** | - | - | 0.0% | - | - | - | - | 0.0% |
| **qwen2.5-14b-instruct** | - | - | 27.5% | - | - | - | - | 27.5% |
| **qwen2.5-7b-instruct** | - | - | - | - | - | - | - | - |
| **qwen2.5-3b-instruct** | - | - | - | - | - | - | - | - |
| **Llama-3.3-70B-Instruct** | 0.0% | 0.0% | 0.0% | 0.0%* | 0.0%* | 0.0%* | 0.0%* | 0.0% |

**测试状态**: 📊 16.5%完成 (922/5,600) - 新增Llama测试了后4种高难度缺陷  
*注: Llama-3.3-70B的后4种缺陷（标*）由llama-3.3-70b-instruct-3实例测试

### 缺陷类型详细分析

#### 1. 顺序错误 (Sequence Disorder)
- **描述**: 工具执行顺序被打乱
- **挑战级别**: 中等
- **预期表现**: 大模型应能识别依赖关系并重排序

| 模型名称 | 成功率 | 部分成功率 | 失败率 | 测试数量 |
|---------|-------|-----------|-------|----------|
| **DeepSeek-V3-0324** | 95.0% | 54.0% | 5.0% | 100 |
| **DeepSeek-R1-0528** | - | - | - | - |
| **qwen2.5-72b-instruct** | 0.0% | 0.0% | 100.0% | 17 |
| **Llama-3.3-70B-Instruct** | 0.0% | 0.0% | 100.0% | 30 |

#### 2. 工具误用 (Tool Misuse)
- **描述**: 使用错误的工具完成任务
- **挑战级别**: 高
- **预期表现**: 需要理解工具语义并选择正确工具

| 模型名称 | 成功率 | 部分成功率 | 失败率 | 测试数量 |
|---------|-------|-----------|-------|----------|
| **DeepSeek-V3-0324** | 24.4% | 24.4% | 75.6% | 86 |
| **DeepSeek-R1-0528** | - | - | - | - |
| **qwen2.5-72b-instruct** | 0.0% | 0.0% | 100.0% | 78 |
| **Llama-3.3-70B-Instruct** | 0.0% | 0.0% | 100.0% | 30 |

#### 3. 参数错误 (Parameter Error)
- **描述**: 工具参数配置错误
- **挑战级别**: 低
- **预期表现**: 应能识别并修正参数值

| 模型名称 | 成功率 | 部分成功率 | 失败率 | 测试数量 |
|---------|-------|-----------|-------|----------|
| **DeepSeek-V3-0324** | 100.0% | 33.3% | 0.0% | 30 |
| **DeepSeek-R1-0528** | - | - | - | - |
| **qwen2.5-72b-instruct** | 0.0% | 0.0% | 100.0% | 27 |
| **qwen2.5-32b-instruct** | 0.0% | 0.0% | 100.0% | 16 |
| **qwen2.5-14b-instruct** | 27.5% | 27.5% | 72.5% | 40 |
| **Llama-3.3-70B-Instruct** | 0.0% | 0.0% | 100.0% | 30 |

#### 4. 缺失步骤 (Missing Step)
- **描述**: 工作流缺少必要步骤
- **挑战级别**: 高
- **预期表现**: 需要推理出缺失的步骤

| 模型名称 | 成功率 | 部分成功率 | 失败率 | 测试数量 |
|---------|-------|-----------|-------|----------|
| **DeepSeek-V3-0324** | 100.0% | 62.1% | 0.0% | 29 |
| **DeepSeek-R1-0528** | - | - | - | - |
| **Llama-3.3-70B-Instruct** | 0.0% | 0.0% | 100.0% | 40* |

#### 5. 冗余操作 (Redundant Operations)
- **描述**: 包含不必要的重复步骤
- **挑战级别**: 低-中
- **预期表现**: 应识别并跳过冗余步骤

| 模型名称 | 成功率 | 部分成功率 | 失败率 | 测试数量 |
|---------|-------|-----------|-------|----------|
| **DeepSeek-V3-0324** | 100.0% | 58.6% | 0.0% | 29 |
| **DeepSeek-R1-0528** | - | - | - | - |
| **Llama-3.3-70B-Instruct** | 0.0% | 0.0% | 100.0% | 40* |

#### 6. 逻辑不连续 (Logical Inconsistency)
- **描述**: 步骤间逻辑关系错误
- **挑战级别**: 高
- **预期表现**: 需要深度理解任务逻辑

| 模型名称 | 成功率 | 部分成功率 | 失败率 | 测试数量 |
|---------|-------|-----------|-------|----------|
| **DeepSeek-V3-0324** | - | - | - | - |
| **DeepSeek-R1-0528** | - | - | - | - |
| **Llama-3.3-70B-Instruct** | 0.0% | 0.0% | 100.0% | 40* |

#### 7. 语义漂移 (Semantic Drift)
- **描述**: 任务目标偏离原始意图
- **挑战级别**: 极高
- **预期表现**: 需要保持任务语义一致性

| 模型名称 | 成功率 | 部分成功率 | 失败率 | 测试数量 |
|---------|-------|-----------|-------|----------|
| **DeepSeek-V3-0324** | - | - | - | - |
| **DeepSeek-R1-0528** | - | - | - | - |
| **Llama-3.3-70B-Instruct** | 0.0% | 0.0% | 100.0% | 40* |

## 测试命令

```bash
# 运行缺陷工作流适应性测试
./run_systematic_test_final.sh

# 选择测试类型
5.3 缺陷工作流适应性测试

# 测试配置
- 难度: easy
- 缺陷类型: 7种
- 工具成功率: 0.8
```

## 预期发现

### 缺陷类型难度排序（预期）
1. **低难度**: 参数错误、冗余操作
2. **中难度**: 顺序错误
3. **高难度**: 工具误用、缺失步骤、逻辑不连续
4. **极高难度**: 语义漂移

### 模型鲁棒性预期
- **高鲁棒性模型特征**:
  - 能识别并纠正大部分缺陷
  - 纠正步数少，效率高
  - 对不同缺陷类型表现稳定

- **低鲁棒性模型特征**:
  - 直接执行缺陷工作流
  - 无法识别逻辑问题
  - 在高难度缺陷上失败率高

## 评分标准

### 适应性得分计算
```python
adaptability_score = (
    sequence_disorder_rate * 0.15 +
    tool_misuse_rate * 0.20 +
    parameter_error_rate * 0.10 +
    missing_step_rate * 0.20 +
    redundant_ops_rate * 0.10 +
    logical_inconsistency_rate * 0.15 +
    semantic_drift_rate * 0.10
)
```

## 关键发现

### 测试完成情况统计（最新）
- **DeepSeek-V3-0324**: 5/7种缺陷已测试（274个测试）
- **Llama-3.3-70B-Instruct**: 7/7种缺陷已测试（250个测试，含两个实例）
  - 主实例: 前3种缺陷（90个测试）
  - llama-3.3-70b-instruct-3: 后4种缺陷（160个测试）
- **qwen2.5-72b-instruct**: 3/7种缺陷已测试（122个测试）
- **qwen2.5-14b-instruct**: 1/7种缺陷已测试（40个测试）
- **qwen2.5-32b-instruct**: 1/7种缺陷已测试（16个测试）
- **其他测试实例**: 
  - deepseek-v3-0324-2: 88个测试
  - deepseek-v3-0324-3: 115个测试
  - deepseek-r1-0528-2/3: 15个测试
  - gpt-4o-mini: 2个测试

### 模型表现分析

#### DeepSeek-V3-0324
- **优势缺陷类型**: 参数错误(100%)、缺失步骤(100%)、冗余操作(100%)、顺序错误(95%)
- **劣势缺陷类型**: 工具误用(24.4%) - 模型难以识别并纠正错误的工具选择
- **平均适应性得分**: 74.5% (基于5种已测试缺陷)
- **特点**: 对参数和结构性缺陷纠正能力强，但对语义级别的工具误用纠正能力弱
- **未测试**: 逻辑不连续、语义漂移

#### Llama-3.3-70B-Instruct（新增）
- **测试覆盖**: 7/7种缺陷全部测试（唯一完成全部测试的模型）
- **表现**: 所有缺陷类型均完全失败(0%)
- **特别发现**: 测试了DeepSeek未测的两种高难度缺陷（逻辑不连续、语义漂移）
- **问题诊断**: 可能存在prompt格式或API调用问题

### Qwen系列问题
- **qwen2.5-72b**: 所有3种已测试缺陷类型均完全失败(0%)
- **qwen2.5-14b**: 仅参数错误有部分纠正能力(27.5%)
- **原因推测**: API调用问题导致模型无法正常工作

### 缺陷难度验证
基于DeepSeek-V3的测试结果，缺陷难度排序：
1. **最容易纠正**: 参数错误(100%)、缺失步骤(100%)、冗余操作(100%)
2. **中等难度**: 顺序错误(95%)
3. **最难纠正**: 工具误用(15%)
4. **未测试**: 逻辑不连续、语义漂移（预期为高难度）

---

**数据来源**: pilot_bench_cumulative_results/master_database.json  
**创建时间**: 2025年8月16日  
**最新更新**: 2025年8月16日  
**测试状态**: 📊 16.5%完成 - 总计922个缺陷测试已执行  
**数据完整性**: 922/5,600个预期测试  
**新增发现**: 
- Llama-3.3成为首个完成全部7种缺陷测试的模型（但全部失败）
- 发现多个模型测试实例（可能是并行测试）
- 新增473个测试（相比之前记录）